<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>HDí˜„ëŒ€ì‚¼í˜¸ E-7 ì¸ì„±ê²€ì‚¬ (Final v36.3 Random)</title><script src="https://cdn.tailwindcss.com/3.4.1"></script><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Roboto:wght@400;700;900&display=swap" rel="stylesheet"><style>:root{--hd-blue:#002c5f;--hd-green:#009539;--hd-light:#e6eef5;--system-accent:#3b82f6;--glass-bg:rgba(255,255,255,0.05);--glass-border:rgba(255,255,255,0.1)}body{font-family:'Noto Sans KR',sans-serif;user-select:none;-webkit-tap-highlight-color:transparent;background-color:#0f172a;color:#fff;overflow-x:hidden;min-height:100vh}.font-eng{font-family:'Roboto',sans-serif}.font-kor{font-family:'Noto Sans KR',sans-serif}.bg-system-pattern{background:radial-gradient(circle at 20% 30%,rgba(30,58,138,0.4) 0%,transparent 40%),radial-gradient(circle at 80% 70%,rgba(59,130,246,0.3) 0%,transparent 40%),#0f172a;background-attachment:fixed}.grid-overlay{position:fixed;inset:0;background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}.fade-in{animation:fadeIn 0.8s cubic-bezier(0.16,1,0.3,1)}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.glass-card{background:var(--glass-bg);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--glass-border);box-shadow:0 25px 50px -12px rgba(0,0,0,0.5)}.btn-premium{background:linear-gradient(135deg,#1e40af 0%,#1d4ed8 100%);box-shadow:0 4px 15px rgba(30,64,175,0.4),inset 0 1px 1px rgba(255,255,255,0.3);transition:all 0.3s cubic-bezier(0.23,1,0.32,1)}.btn-premium:hover{transform:translateY(-2px);filter:brightness(1.1)}.btn-premium:active{transform:translateY(1px)}.system-input{background:rgba(255,255,255,0.03)!important;border:1px solid rgba(255,255,255,0.1)!important;color:#fff!important}.system-input:focus{background:rgba(255,255,255,0.07)!important;border-color:var(--system-accent)!important}.lang-btn-premium{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);transition:all 0.2s cubic-bezier(0.4,0,0.2,1)}.lang-btn-premium:hover{background:rgba(255,255,255,0.08);border-color:rgba(255,255,255,0.3);transform:translateY(-1px)}.lang-btn-premium.active{background:linear-gradient(135deg,#1e40af 0%,#2563eb 100%);border-color:#60a5fa;box-shadow:0 0 20px rgba(59,130,246,0.4),inset 0 1px 0 rgba(255,255,255,0.2);transform:scale(1.02)}.lang-btn-premium.active span{color:white!important;opacity:1!important;font-weight:800}.likert-input:checked+label{background-color:var(--hd-blue);color:white;border-color:var(--hd-blue);transform:scale(1.1);box-shadow:0 0 20px rgba(59,130,246,0.4)}#view-report{display:none;color:#1e293b;background:#525659;overflow:auto}#view-report.active{display:flex;position:fixed;inset:0;z-index:2000;justify-content:center;align-items:flex-start;padding:40px 20px}.a4-page{width:210mm;min-width:210mm;min-height:297mm;padding:15mm 20mm;margin:0 auto;background:white;box-shadow:0 10px 30px rgba(0,0,0,0.5);position:relative;box-sizing:border-box;display:flex;flex-direction:column;color:#1e293b;overflow:hidden;transform-origin:top center}@media print{.no-print{display:none!important}body{background:white}#view-report{position:absolute;top:0;left:0;width:100%;height:100%;overflow:visible;background:white;padding:0;display:block}.a4-page{margin:0;box-shadow:none;width:100%!important;height:auto!important;page-break-after:always;transform:none!important}}.report-header{border-bottom:3px solid var(--hd-blue);padding-bottom:12px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:flex-end}.score-card{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:10px;text-align:center}.score-card .label{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:#64748b;font-weight:700;margin-bottom:4px}.score-card .value{font-size:1.6rem;font-weight:900;color:var(--hd-blue);line-height:1.2;font-family:'Noto Sans KR',sans-serif;word-break:keep-all}.score-card.highlight-card{background-color:var(--hd-blue)!important;border-color:var(--hd-blue)!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.score-card.highlight-card .label{color:#bfdbfe!important}.score-card.highlight-card .value{color:#ffffff!important}.section-title{font-size:1.2rem;font-weight:900;color:var(--hd-blue);display:flex;align-items:center;gap:8px;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid #e2e8f0}.section-title span{background:var(--hd-blue);color:white;width:24px;height:24px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:14px}.score-table{width:100%;font-size:0.8rem;border-collapse:separate;border-spacing:0 4px;height:100%}.score-table th{text-align:left;color:#64748b;font-size:0.7rem;text-transform:uppercase;padding:0 8px;font-weight:800;letter-spacing:0.05em}.score-table td{background:#fff;padding:2px 8px;border-top:1px solid #f1f5f9;border-bottom:1px solid #f1f5f9;vertical-align:middle}.score-table tr td:first-child{border-left:1px solid #f1f5f9;border-top-left-radius:6px;border-bottom-left-radius:6px;font-weight:700;color:#334155}.score-table tr td:last-child{border-right:1px solid #f1f5f9;border-top-right-radius:6px;border-bottom-right-radius:6px}.grade-badge{display:inline-block;width:22px;height:22px;line-height:22px;text-align:center;border-radius:50%;font-weight:900;font-size:0.8rem;color:white;font-family:'Roboto',sans-serif}.grade-S{background-color:#4f46e5}.grade-A{background-color:#3b82f6}.grade-B{background-color:#10b981}.grade-C{background-color:#f59e0b}.grade-D{background-color:#ef4444}.ai-markdown h2{font-size:1.4rem;font-weight:900;color:var(--hd-blue);margin-top:1.5rem;margin-bottom:1rem;border-bottom:3px solid var(--hd-blue);padding-bottom:6px}.ai-markdown h3{font-size:1.1rem;font-weight:800;color:#334155;margin-top:1.2rem;margin-bottom:0.6rem;border-left:4px solid var(--system-accent);padding-left:10px}.ai-markdown p{font-size:0.95rem;line-height:1.7;color:#1e293b;margin-bottom:0.8rem;text-align:justify;word-break:keep-all}.ai-markdown ul{list-style:none;padding:0;margin-bottom:1rem}.ai-markdown li{position:relative;padding-left:18px;font-size:0.95rem;color:#334155;margin-bottom:6px;line-height:1.6}.ai-markdown li::before{content:"â€¢";position:absolute;left:0;color:var(--system-accent);font-weight:bold;font-size:1.2em}.ai-markdown table{width:100%;border-collapse:collapse;margin-bottom:1.2rem;font-size:0.9rem;border:2px solid #cbd5e1}.ai-markdown th{background-color:#f8fafc;padding:10px;border:1px solid #94a3b8;font-weight:800;color:var(--hd-blue);text-align:center}.ai-markdown td{padding:8px 12px;border:1px solid #94a3b8;color:#1e293b;vertical-align:middle}.ai-markdown strong{color:var(--hd-blue);font-weight:900}.ai-markdown blockquote{background:#f1f5f9;border-left:4px solid var(--hd-blue);padding:1rem;margin:1rem 0;font-style:italic;color:#475569}.chart-wrapper{position:relative;height:100%;width:100%}.filter-btn{padding:0.5rem 1rem;border-radius:0.75rem;font-size:0.75rem;font-weight:800;border:1px solid #e2e8f0;color:#64748b;background:white;transition:all 0.2s}.filter-btn:hover{background:#f1f5f9}.filter-btn.active{background:var(--hd-blue);color:white;border-color:var(--hd-blue);box-shadow:0 4px 6px -1px rgba(30,58,138,0.3)}.fixed-table{table-layout:fixed;width:100%}.col-source{width:10%}.col-name{width:20%}.col-id{width:12%}.col-date{width:12%}.col-score{width:8%}.col-rel{width:10%}.col-grade{width:14%}.col-action{width:7%}
/* [ìˆ˜ì •] ë³´ê³ ì„œ í…Œì´ë¸” ì²« ë²ˆì§¸ ì—´(êµ¬ë¶„, ì˜ì—­) ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©: ë„ˆë¹„ í™•ë³´ ë° ê°€ìš´ë° ì •ë ¬ */
.ai-markdown table th:first-child, .ai-markdown table td:first-child {
    width: 15%; /* ì ì ˆí•œ ë„ˆë¹„ í• ë‹¹ */
    min-width: 60px !important; /* ìµœì†Œ ë„ˆë¹„ 60px ê°•ì œ ì ìš© (ê°€ë¡œ ê³µê°„ í™•ë³´) */
    text-align: center !important; /* ê°€ìš´ë° ì •ë ¬ ê°•ì œ */
    word-break: keep-all; /* ë‹¨ì–´ ì¤‘ê°„ì— ëŠê¸°ì§€ ì•Šë„ë¡ ì„¤ì • */
    white-space: pre-wrap; /* ì¤„ë°”ê¿ˆ íƒœê·¸ ì ìš© ë° ìë™ ì¤„ë°”ê¿ˆ */
    vertical-align: middle; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
}
@media screen and (min-width:768px) and (max-height:850px){.compact-on-short{padding:1.5rem!important}.text-compact-on-short{font-size:1.5rem!important;margin-bottom:0.5rem!important}.subtext-compact-on-short{font-size:0.875rem!important;margin-top:0.5rem!important;padding-top:0.5rem!important}.likert-compact-on-short{padding-top:0.5rem!important;gap:0.5rem!important}}</style></head><body class="bg-system-pattern min-h-screen flex flex-col"><div class="grid-overlay"></div><div id="kakaotalk-guide" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999;flex-direction:column;align-items:center;justify-content:center;color:white;text-align:center;padding:20px;"><div class="guide-arrow" style="position:absolute;top:20px;right:20px;font-size:3rem;animation:bounceRight 1.5s infinite;">ğŸ‘†</div><div class="max-w-xs"><div class="text-6xl mb-6">âš ï¸</div><h2 class="text-2xl font-black text-yellow-400 mb-4 break-keep">ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì•ˆë‚´</h2><p class="text-lg font-bold mb-8 leading-relaxed text-white/90 break-keep">ì¹´ì¹´ì˜¤í†¡ ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œëŠ”<br>ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><div class="bg-white/10 rounded-2xl p-6 border border-white/20 text-left space-y-4 mb-8"><div class="flex items-start gap-3"><span class="bg-yellow-400 text-black font-black rounded-full w-6 h-6 flex items-center justify-center text-sm mt-0.5">1</span><span class="font-bold text-sm">ìš°ì¸¡ ìƒë‹¨ <span class="text-yellow-400 text-lg">â‹®</span> ë˜ëŠ” <span class="text-yellow-400 text-lg">â‹¯</span> ë²„íŠ¼ í´ë¦­</span></div><div class="flex items-start gap-3"><span class="bg-yellow-400 text-black font-black rounded-full w-6 h-6 flex items-center justify-center text-sm mt-0.5">2</span><span class="font-bold text-sm text-yellow-400">'ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°'</span><span class="font-bold text-sm">ì„ íƒ</span></div><div class="flex items-start gap-3"><span class="bg-yellow-400 text-black font-black rounded-full w-6 h-6 flex items-center justify-center text-sm mt-0.5">3</span><span class="font-bold text-sm">Chrome / Safari / Samsung Internet ë“±ìœ¼ë¡œ ì ‘ì†</span></div></div><button onclick="document.getElementById('kakaotalk-guide').style.display='none'" class="text-sm text-white/40 underline">ë‹«ê¸° (í…ŒìŠ¤íŠ¸ìš©)</button></div></div><div id="qr-modal" class="hidden fixed inset-0 bg-black/90 backdrop-blur-xl flex items-center justify-center p-4 fade-in z-[3000]" onclick="if(event.target===this)document.getElementById('qr-modal').classList.add('hidden')"><div class="bg-white p-8 rounded-[3rem] shadow-2xl text-center max-w-sm w-full" onclick="event.stopPropagation()"><h3 class="text-2xl font-black text-gray-900 mb-2">SCAN TO START</h3><p class="text-sm text-gray-500 font-bold mb-4">ì ‘ì† URL í™•ì¸ (ìˆ˜ì • ê°€ëŠ¥)</p><input type="text" id="qr-url-input" class="w-full bg-slate-100 border border-slate-200 rounded-xl p-3 text-xs font-mono text-slate-600 mb-6 outline-none focus:border-blue-500 transition-colors text-center" placeholder="https://..." oninput="window.generateQRFromInput()"><div class="flex justify-center mb-6"><div id="qrcode-display" class="border-4 border-white shadow-lg rounded-xl overflow-hidden bg-white p-2"></div></div><button onclick="document.getElementById('qr-modal').classList.add('hidden')" class="bg-slate-800 text-white px-8 py-3 rounded-2xl font-black hover:bg-slate-700 transition-colors shadow-lg w-full">ë‹«ê¸°</button></div></div><div id="confirm-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center p-4 fade-in z-[3000]"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-sm w-full text-center"><div class="text-5xl mb-5">ğŸ—‘ï¸</div><h3 class="text-xl font-black text-gray-900 mb-2">ì‚­ì œ í™•ì¸</h3><p id="confirm-message" class="text-gray-600 mb-8 text-base break-keep leading-relaxed font-medium">ì„ íƒí•œ í•­ëª©ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p><div class="flex gap-3"><button onclick="document.getElementById('confirm-modal').classList.add('hidden')" class="flex-1 bg-slate-100 text-slate-500 py-3 rounded-2xl font-bold hover:bg-slate-200 transition-colors">ì·¨ì†Œ</button><button id="confirm-yes-btn" class="flex-1 bg-red-600 text-white py-3 rounded-2xl font-bold shadow-lg hover:bg-red-700 transition-colors">ì‚­ì œ</button></div></div></div><script>const GOOGLE_SCRIPT_URL="https://script.google.com/macros/s/AKfycbzDs_3Ri4yyAE5KPKSBZO6H6HQFq8tf9t_j3oa09UbWOjseEkm079iSDsduoppk5wlA/exec";const apiKey="";</script><div id="custom-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center p-4 fade-in z-[3000]"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-sm w-full text-center"><div id="modal-icon" class="text-5xl mb-5">âš ï¸</div><h3 id="modal-title" class="text-xl font-black text-gray-900 mb-2">ì‹œìŠ¤í…œ ì•Œë¦¼</h3><p id="modal-message" class="text-gray-600 mb-8 text-base break-keep leading-relaxed font-medium"></p><button onclick="window.closeModal()" class="bg-blue-900 text-white px-8 py-3 rounded-2xl font-bold w-full shadow-lg">í™•ì¸</button></div></div><div id="app-container" class="flex-grow flex flex-col relative z-10 h-full"><div class="absolute top-6 right-6 z-50 no-print hidden md:block"><button onclick="window.showAdminLogin()" class="bg-white/10 hover:bg-white/20 text-white/70 hover:text-white font-bold px-4 py-2 text-xs border border-white/20 rounded-full transition-all backdrop-blur-md flex items-center gap-2"><span>ğŸ”’</span><span>ADMIN</span></button></div><div id="view-home" class="flex-grow flex flex-col items-center justify-center p-6 fade-in min-h-[100dvh]"><div class="glass-card p-10 md:p-16 rounded-[3rem] max-w-2xl w-full text-center relative overflow-hidden"><div class="absolute -top-24 -left-24 w-48 h-48 bg-blue-600/20 rounded-full blur-3xl"></div><div class="relative z-10 mb-12"><img src="hd_logo.png" alt="HD Hyundai" class="h-14 md:h-20 w-auto mx-auto mb-8 drop-shadow-2xl hover:scale-105 transition-transform duration-500" onerror="this.style.display='none';document.getElementById('fallback-logo').classList.remove('hidden')"><div id="fallback-logo" class="hidden text-white font-black text-3xl md:text-4xl tracking-tighter uppercase font-eng mb-8">HD Hyundai Samho</div><div class="inline-flex items-center gap-3 bg-white/10 px-4 py-1.5 rounded-full border border-white/10 mb-6"><span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span><span class="text-[10px] font-bold tracking-[0.3em] uppercase opacity-70">Automated Assessment System</span></div><h1 class="text-4xl md:text-6xl font-black text-white mb-4 tracking-tighter leading-tight break-keep">E-7 ì™¸êµ­ì¸ ê·¼ë¡œì<br><span class="text-blue-400">ì¸ì„±ê²€ì‚¬ ì‹œìŠ¤í…œ</span></h1><p class="text-white/40 text-xs md:text-sm font-medium tracking-widest font-eng">V36.3 FINAL (SAFETY+V3 GUARD+ADMIN EXCEL)</p></div><div class="relative z-10 flex flex-col gap-6 max-w-md mx-auto"><button onclick="window.checkUrlAndStart()" class="btn-premium w-full text-white font-black py-6 md:py-8 rounded-[1.5rem] text-2xl md:text-3xl font-eng tracking-tight flex items-center justify-center gap-4 group"><span>START SYSTEM</span><svg class="w-6 h-6 md:w-8 md:h-8 group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg></button><div class="flex justify-center gap-3 opacity-60"><span class="bg-white/10 px-4 py-2 rounded-xl text-2xl border border-white/5 cursor-default hover:bg-white/20 transition-colors shadow-sm" title="í•œêµ­ì–´">ğŸ‡°ğŸ‡·</span><span class="bg-white/10 px-4 py-2 rounded-xl text-2xl border border-white/5 cursor-default hover:bg-white/20 transition-colors shadow-sm" title="Tiáº¿ng Viá»‡t">ğŸ‡»ğŸ‡³</span><span class="bg-white/10 px-4 py-2 rounded-xl text-2xl border border-white/5 cursor-default hover:bg-white/20 transition-colors shadow-sm" title="Indonesia">ğŸ‡®ğŸ‡©</span><span class="bg-white/10 px-4 py-2 rounded-xl text-2xl border border-white/5 cursor-default hover:bg-white/20 transition-colors shadow-sm" title="English">ğŸ‡ºğŸ‡¸</span></div></div><div class="relative z-10 mt-16 pt-8 border-t border-white/10 flex justify-between items-center text-[10px] md:text-xs text-white/30 font-bold uppercase tracking-widest"><div class="flex items-center gap-2"><span class="text-blue-400">â—</span><span>Stored: <span id="stored-count" class="text-white/60">0</span></span></div><div>HD Hyundai Samho</div></div></div></div><div id="view-login" class="hidden flex-grow flex flex-col items-center justify-center p-4 fade-in min-h-[100dvh]"><div class="glass-card p-10 md:p-14 rounded-[3rem] max-w-xl w-full relative overflow-hidden"><div class="absolute -top-10 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl"></div><div class="relative z-10 mb-10 text-center"><div class="inline-block bg-blue-500/10 text-blue-400 px-4 py-1 rounded-full text-[10px] font-black tracking-[0.2em] uppercase border border-blue-500/20 mb-4">Verification Layer</div><h2 class="text-3xl md:text-4xl font-black text-white font-eng uppercase tracking-tight">System Access</h2></div><div class="relative z-10 space-y-8 max-w-md mx-auto"><div class="group"><label class="block text-[15px] font-black text-blue-400 mb-2 uppercase tracking-widest ml-1">ì„±ëª… (Full Name / English)</label><input type="text" id="input-name" class="system-input w-full p-5 rounded-2xl outline-none font-bold text-lg tracking-tight" placeholder="Ex. John Doe"></div><div class="group"><label class="block text-[15px] font-black text-blue-400 mb-2 uppercase tracking-widest ml-1">ì‘ì‹œë²ˆí˜¸ (Candidate Number)</label><input type="text" id="input-id" class="system-input w-full p-5 rounded-2xl outline-none font-mono text-lg tracking-widest" placeholder="A1234567"></div><div><label class="block text-[10px] font-black text-gray-500 mb-4 uppercase tracking-widest ml-1">Localization Protocol</label><div class="grid grid-cols-2 gap-4"><button onclick="window.selectLang('vn')" class="lang-btn-premium border rounded-2xl p-5 flex flex-col items-center gap-2 group" id="btn-vn"><span class="text-3xl">ğŸ‡»ğŸ‡³</span><span class="text-xs font-bold text-white/70">Tiáº¿ng Viá»‡t</span></button><button onclick="window.selectLang('id')" class="lang-btn-premium border rounded-2xl p-5 flex flex-col items-center gap-2 group" id="btn-id"><span class="text-3xl">ğŸ‡®ğŸ‡©</span><span class="text-xs font-bold text-white/70">Indonesia</span></button><button onclick="window.selectLang('en')" class="lang-btn-premium border rounded-2xl p-5 flex flex-col items-center gap-2 group" id="btn-en"><span class="text-3xl">ğŸ‡ºğŸ‡¸</span><span class="text-xs font-bold text-white/70">English</span></button><button onclick="window.selectLang('kr')" class="lang-btn-premium border rounded-2xl p-5 flex flex-col items-center gap-2 group" id="btn-kr"><span class="text-3xl">ğŸ‡°ğŸ‡·</span><span class="text-xs font-bold text-white/70">í•œêµ­ì–´</span></button></div></div></div><div class="relative z-10 mt-12 flex gap-4 max-w-md mx-auto"><button onclick="window.resetToHome()" class="flex-1 bg-white/5 hover:bg-white/10 text-white/40 hover:text-white font-black py-5 rounded-2xl transition-all border border-white/5 uppercase tracking-widest text-xs">BACK</button><button onclick="window.showGuide()" class="btn-premium flex-[2] text-white font-black py-5 rounded-2xl text-xl font-eng tracking-tight">CONTINUE</button></div></div></div><div id="view-guide" class="hidden flex-grow flex flex-col items-center justify-center p-4 fade-in min-h-[100dvh]"><div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-2xl max-w-lg w-full text-center border-t-8 border-blue-900 text-slate-800"><h2 id="guide-title" class="text-3xl font-black text-gray-900 mb-8 font-kor">ê²€ì‚¬ ì•ˆë‚´</h2><div class="space-y-6 text-left bg-slate-50 p-8 rounded-3xl mb-8 border border-slate-100"><div class="flex items-center gap-5"><div class="w-14 h-14 rounded-2xl bg-blue-100 flex items-center justify-center text-3xl text-blue-600">â±ï¸</div><div><p class="text-[10px] text-gray-400 font-black uppercase tracking-widest">Time Limit</p><p id="guide-time" class="font-black text-gray-800 text-2xl font-kor">30ë¶„</p></div></div><div class="flex items-center gap-5"><div class="w-14 h-14 rounded-2xl bg-indigo-100 flex items-center justify-center text-3xl text-indigo-600">ğŸ“</div><div><p class="text-[10px] text-gray-400 font-black uppercase tracking-widest">Questions</p><p id="guide-count" class="font-black text-gray-800 text-2xl font-kor">94ë¬¸í•­</p></div></div><div class="flex items-start gap-5 pt-6 border-t border-gray-200 mt-4"><div class="w-14 h-14 rounded-2xl bg-red-100 flex items-center justify-center text-3xl text-red-600">ğŸ’¡</div><div><p class="text-[10px] text-red-400 font-black uppercase tracking-widest">Important Notice</p><p id="guide-warn" class="font-bold text-red-600 text-base leading-snug break-keep font-kor">ì†”ì§í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”.</p></div></div></div><div class="flex gap-4"><button onclick="window.goToLogin()" class="flex-1 bg-slate-100 text-slate-500 font-black py-5 rounded-2xl font-eng">BACK</button><button onclick="window.startRealTest()" id="guide-btn" class="flex-[2] bg-blue-900 text-white font-black py-5 rounded-2xl shadow-xl text-xl font-eng">START SYSTEM</button></div></div></div><div id="view-assessment" class="hidden flex flex-col max-w-6xl mx-auto w-full p-2 md:p-4 fade-in relative h-[100dvh]"><div class="flex-none pt-1 pb-1 px-1 transition-all"><div class="bg-white rounded-2xl shadow-lg border border-white/20 px-4 py-3 md:p-4 flex justify-between items-center mb-2 text-slate-800"><div class="flex items-center"><button onclick="window.prevQuestion()" id="header-btn-prev" class="hidden mr-4 text-blue-600 font-black text-xl hover:text-blue-800 transition-colors p-2 rounded-full hover:bg-blue-50">â—€</button><div class="flex flex-col"><span class="text-[9px] md:text-[10px] text-gray-400 font-black uppercase tracking-widest mb-0.5">Progress</span><div class="flex items-baseline gap-1 md:gap-2"><span class="text-2xl md:text-3xl font-black text-blue-900 tabular-nums" id="current-q-num">1</span><span class="text-xs md:text-sm text-gray-400 font-black">/ 94</span></div></div></div><div class="bg-blue-50 px-4 py-2 md:px-5 md:py-2 rounded-xl md:rounded-2xl border border-blue-100 flex items-center gap-2 md:gap-3"><span class="animate-pulse text-lg md:text-xl">â±ï¸</span><span id="timer-display" class="font-mono font-black text-xl md:text-2xl text-blue-900 tabular-nums">30:00</span></div></div><div class="w-full bg-white/10 rounded-full h-2 md:h-3 overflow-hidden shadow-inner border border-white/5"><div id="progress-bar" class="bg-gradient-to-r from-blue-400 to-blue-600 h-full transition-all duration-300 rounded-full" style="width: 1%"></div></div></div><div class="flex-1 bg-white rounded-[1.5rem] md:rounded-[2.5rem] shadow-2xl border border-white p-4 md:p-8 lg:p-10 mt-1 mb-2 relative overflow-hidden text-slate-800 flex flex-col justify-between compact-on-short"><div class="flex-1 w-full relative z-10 flex flex-col justify-center overflow-y-auto no-scrollbar"><div class="w-full flex flex-col items-center text-center"><h2 id="q-text-native" class="text-xl md:text-3xl lg:text-4xl font-black text-gray-900 mb-2 md:mb-6 leading-snug break-keep tracking-tight text-compact-on-short"></h2><p id="q-text-kr" class="text-gray-400 text-sm md:text-lg border-t-2 border-dashed border-gray-100 pt-2 md:pt-4 mt-2 md:mt-4 inline-block px-4 md:px-8 break-keep font-medium italic subtext-compact-on-short"></p></div></div><div id="likert-container" class="flex-none pt-2 md:pt-6 grid grid-cols-5 gap-2 md:gap-4 lg:gap-8 select-none max-w-5xl mx-auto w-full relative z-10 items-end likert-compact-on-short"></div></div><div class="flex-none mt-auto flex gap-4 pb-2 px-2"><div class="flex-grow"></div><button onclick="window.finishAssessment()" id="btn-submit" class="hidden px-8 py-3 md:px-12 md:py-4 bg-gradient-to-r from-blue-500 to-blue-700 text-white rounded-2xl font-black shadow-xl text-lg md:text-xl flex items-center gap-3"><span>SUBMIT</span></button></div></div><div id="view-upload" class="hidden flex-grow flex flex-col items-center justify-center p-4 fade-in min-h-[100dvh]"><div class="glass-card p-16 rounded-[3rem] shadow-2xl max-w-md w-full text-center"><div class="relative w-24 h-24 mx-auto mb-10"><div class="absolute inset-0 border-8 border-white/10 rounded-full"></div><div class="absolute inset-0 border-8 border-blue-500 rounded-full border-t-transparent animate-spin"></div></div><h2 class="text-2xl md:text-3xl font-black text-white mb-2 tracking-tight">SYSTEM UPLOADING...</h2></div></div><div id="view-thankyou" class="hidden flex-grow flex flex-col items-center justify-center p-4 fade-in min-h-[100dvh]"><div class="glass-card p-12 md:p-20 rounded-[4rem] shadow-2xl max-w-lg w-full text-center"><div class="w-28 h-28 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-10 text-6xl shadow-[0_0_50px_rgba(59,130,246,0.5)] animate-bounce text-white">âœ…</div><h2 class="text-4xl font-black text-white mb-4 tracking-tighter">DATA SUBMITTED</h2><div class="flex flex-col gap-4 w-full"><button onclick="window.resetToHome()" class="w-full bg-white text-blue-900 font-black py-6 rounded-3xl hover:bg-slate-100 transition-all text-xl shadow-xl hover:-translate-y-1">FINISH SYSTEM</button><button onclick="window.downloadLocalData()" class="w-full bg-white/10 text-white/70 font-bold py-4 rounded-3xl hover:bg-white/20 transition-all text-sm border border-white/10 flex items-center justify-center gap-2"><span>ğŸ“‚</span> ê²°ê³¼ íŒŒì¼ ì €ì¥ (ì „ì†¡ ì‹¤íŒ¨ ì‹œ)</button></div></div></div><div id="view-admin-login" class="hidden flex-grow flex flex-col items-center justify-center p-4 fade-in bg-slate-900/90 min-h-[100dvh]"><div class="bg-white p-12 rounded-[3rem] shadow-2xl max-w-sm w-full text-slate-800"><h2 class="text-2xl font-black text-gray-900 mb-8 flex items-center gap-3">ğŸ”’ SYSTEM ADMIN</h2><input type="password" id="admin-pw" class="w-full bg-slate-50 border-2 p-5 rounded-2xl mb-8 text-xl focus:border-blue-900 outline-none font-bold" placeholder="Access Key"><div class="flex gap-4"><button onclick="window.resetToHome()" class="flex-1 bg-slate-100 hover:bg-slate-200 text-slate-500 py-4 rounded-2xl font-black">BACK</button><button onclick="window.checkAdminPw()" class="flex-2 bg-blue-900 hover:bg-blue-800 text-white py-4 rounded-2xl font-black">LOGIN</button></div></div></div><div id="view-admin-dashboard" class="hidden flex-grow max-w-7xl mx-auto w-full p-4 fade-in h-screen flex flex-col text-slate-800"><div class="bg-white rounded-[2.5rem] shadow-2xl border border-white overflow-hidden flex flex-col flex-grow"><div class="p-6 border-b bg-slate-50"><div class="flex justify-between items-center flex-wrap gap-4 mb-4"><div><div class="flex items-center gap-3"><h2 class="font-black text-2xl text-gray-900 uppercase tracking-tight">Dashboard <span id="db-count-badge" class="bg-blue-600 text-white text-xs px-3 py-1 rounded-full align-middle">0</span></h2></div></div><div class="flex gap-3"><button onclick="window.showQRCode()" class="bg-indigo-600 text-white px-6 py-3 rounded-2xl text-sm font-black shadow-md flex items-center gap-2"><span>ğŸ“± QR CODE</span></button><label class="cursor-pointer bg-white border-2 border-blue-600 text-blue-600 hover:bg-blue-50 px-6 py-3 rounded-2xl text-sm font-black shadow-sm transition-all flex items-center gap-2"><span>ğŸ“‚ UPLOAD</span><input type="file" id="excelInput" accept=".xlsx, .xls, .csv, .json" class="hidden" onchange="window.handleFileUpload(this)"></label><button onclick="window.downloadTableAsExcel()" class="bg-blue-700 text-white px-6 py-3 rounded-2xl text-sm font-black shadow-md flex items-center gap-2"><span>ğŸ“¥ EXCEL (ALL)</span></button><button onclick="window.openGoogleSheet()" class="bg-green-600 text-white px-6 py-3 rounded-2xl text-sm font-black shadow-md">SHEET (Backup)</button><button onclick="window.resetToHome()" class="bg-slate-800 text-white px-6 py-3 rounded-2xl text-sm font-black">EXIT</button></div></div><div class="flex flex-col md:flex-row gap-4 bg-slate-50 p-4 rounded-2xl border border-slate-100"><div class="relative flex-grow max-w-md"><span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400">ğŸ”</span><input type="text" id="dashboard-search" oninput="window.handleSearch(this.value)" class="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 outline-none focus:border-blue-500 font-bold text-sm text-slate-700 placeholder-slate-400" placeholder="ì´ë¦„ ë˜ëŠ” ìˆ˜í—˜ë²ˆí˜¸ ê²€ìƒ‰..."></div><div class="flex gap-2 overflow-x-auto pb-1 md:pb-0" id="filter-container"><button onclick="window.setFilter('ALL')" class="filter-btn active" id="filter-ALL">ì „ì²´</button><button onclick="window.setFilter('S')" class="filter-btn" id="filter-S">S ë“±ê¸‰</button><button onclick="window.setFilter('A')" class="filter-btn" id="filter-A">A ë“±ê¸‰</button><button onclick="window.setFilter('B')" class="filter-btn" id="filter-B">B ë“±ê¸‰</button><button onclick="window.setFilter('C')" class="filter-btn" id="filter-C">C ë“±ê¸‰</button><button onclick="window.setFilter('D')" class="filter-btn" id="filter-D">D ë“±ê¸‰</button></div></div></div><div class="overflow-auto flex-grow bg-white"><table class="fixed-table text-sm text-left"><thead class="bg-slate-50 border-b text-slate-400 uppercase font-black text-[10px] tracking-widest sticky top-0 shadow-sm z-10"><tr><th class="px-4 py-5 col-source cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('source')">Source <span id="sort-arrow-source" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 col-name cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('name')">Name <span id="sort-arrow-name" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 col-id cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('id')">ID <span id="sort-arrow-id" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 col-date cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('date')">Date <span id="sort-arrow-date" class="text-[9px] ml-1">â–¼</span></th><th class="px-4 py-5 text-center col-score cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('total')">Score <span id="sort-arrow-total" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 text-center col-rel cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('reliability')">Rel <span id="sort-arrow-reliability" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 text-center col-grade cursor-pointer hover:text-blue-500 transition-colors select-none" onclick="window.handleSort('decision')">Grade <span id="sort-arrow-decision" class="text-[9px] ml-1"></span></th><th class="px-4 py-5 text-center col-action">View</th><th class="px-4 py-5 text-center col-action">Delete</th></tr></thead><tbody id="dashboard-tbody" class="divide-y divide-slate-100 font-medium"></tbody></table></div></div></div><div id="view-report" class="hidden"><div id="report-content-wrapper" class="transform-origin-top transition-transform"></div></div></div><script>var GUIDE_TEXTS={kr:{title:"ê²€ì‚¬ ì•ˆë‚´",timeLabel:"Time Limit",timeVal:"30ë¶„",countLabel:"Questions",countVal:"94ë¬¸í•­",warnLabel:"Important Notice",warnVal:"ì†”ì§í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”.<br>ë‹µë³€ì´ ì¼ê´€ë˜ì§€ ì•Šìœ¼ë©´ ë¶ˆí•©ê²© ì²˜ë¦¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",btn:"START SYSTEM"},vn:{title:"HÆ°á»›ng dáº«n kiá»ƒm tra",timeLabel:"Thá»i gian",timeVal:"30 phÃºt",countLabel:"CÃ¢u há»i",countVal:"94 cÃ¢u",warnLabel:"LÆ°u Ã½ quan trá»ng",warnVal:"HÃ£y tráº£ lá»i trung thá»±c.<br>Náº¿u cÃ¢u tráº£ lá»i khÃ´ng nháº¥t quÃ¡n, báº¡n cÃ³ thá»ƒ bá»‹ trÆ°á»£t.",btn:"Báº®T Äáº¦U"},id:{title:"Panduan Tes",timeLabel:"Waktu",timeVal:"30 menit",countLabel:"Pertanyaan",countVal:"94 butir",warnLabel:"Pemberitahuan Penting",warnVal:"Jawablah dengan jujur.<br>Jika jawaban tidak konsisten, Anda mungkin gagal.",btn:"MULAI SISTEM"},en:{title:"Test Guide",timeLabel:"Time Limit",timeVal:"30 min",countLabel:"Questions",countVal:"94 items",warnLabel:"Important Notice",warnVal:"Please answer honestly.<br>Inconsistent answers may result in failure.",btn:"START SYSTEM"}};
// [ê°œì„ ëœ ë¬¸í•­ ì ìš©] ì™¸êµ­ì¸ ì´í•´ë„ ë° ë²ˆì—­ ì •í™•ì„±ì„ ê³ ë ¤í•˜ì—¬ ë¬¸ì¥ì„ ë‹¤ë“¬ì—ˆìŠµë‹ˆë‹¤.
var QUESTIONS_FULL=[{id:1,type:'C1',rev:false,kr:"ë‚˜ëŠ” ì‘ì—… ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì¼ì° ë„ì°©í•´ì„œ ì¤€ë¹„í•œë‹¤.",en:"I arrive earlier than the start time to prepare for work.",vn:"TÃ´i Ä‘áº¿n sá»›m hÆ¡n giá» lÃ m viá»‡c Ä‘á»ƒ chuáº©n bá»‹.",ind:"Saya datang lebih awal dari jam kerja untuk bersiap-siap."},{id:2,type:'C1',rev:true,kr:"ë‚˜ëŠ” ì˜¤ëŠ˜ í•´ì•¼ í•  ì¼ì„ ë‚´ì¼ë¡œ ë¯¸ë£° ë•Œê°€ ìˆë‹¤.",en:"I sometimes put off today's work until tomorrow.",vn:"ÄÃ´i khi tÃ´i trÃ¬ hoÃ£n cÃ´ng viá»‡c cá»§a hÃ´m nay sang ngÃ y mai.",ind:"Terkadang saya menunda pekerjaan hari ini hingga besok."},{id:3,type:'C1',rev:false,kr:"ì¼í•˜ëŠ” ì‹œê°„ì—ëŠ” ê°œì¸ì ì¸ íœ´ëŒ€í° ì‚¬ìš©ì„ í•˜ì§€ ì•Šìœ¼ë ¤ í•œë‹¤.",en:"I try not to use my personal phone during working hours.",vn:"TÃ´i cá»‘ gáº¯ng khÃ´ng sá»­ dá»¥ng Ä‘iá»‡n thoáº¡i cÃ¡ nhÃ¢n trong giá» lÃ m viá»‡c.",ind:"Saya berusaha tidak menggunakan ponsel pribadi selama jam kerja."},{id:4,type:'C1',rev:false,kr:"ì •í•´ì§„ ì‹œê°„ ì•ˆì— ì¼ì„ ëë‚´ê¸° ìœ„í•´ ì„œë‘˜ëŸ¬ì„œ ì¼í•œë‹¤.",en:"I maintain a pace to finish tasks within the designated hours.",vn:"TÃ´i lÃ m viá»‡c kháº©n trÆ°Æ¡ng Ä‘á»ƒ hoÃ n thÃ nh cÃ´ng viá»‡c trong thá»i gian quy Ä‘á»‹nh.",ind:"Saya bekerja dengan cepat untuk menyelesaikan tugas dalam waktu yang ditentukan."},{id:5,type:'C1',rev:true,kr:"í”¼ê³¤í•˜ë©´ ì¼ì— ì§‘ì¤‘í•˜ì§€ ëª»í•˜ê³  ë‹¤ë¥¸ ì§“ì„ í•  ë•Œê°€ ìˆë‹¤.",en:"When I am tired, I lose focus and do other things.",vn:"Khi má»‡t má»i, tÃ´i máº¥t táº­p trung vÃ  lÃ m viá»‡c khÃ¡c.",ind:"Saat lelah, saya kehilangan fokus dan melakukan hal lain."},{id:6,type:'C1',rev:false,kr:"ì˜¤ëŠ˜ í•  ì¼ì„ ë©”ëª¨ì§€ë‚˜ ë‹¬ë ¥ì— ì ì–´ì„œ ê´€ë¦¬í•œë‹¤.",en:"I write down tasks on a note or calendar to manage them.",vn:"TÃ´i ghi chÃ©p cÃ´ng viá»‡c cáº§n lÃ m vÃ o giáº¥y nhá»› hoáº·c lá»‹ch Ä‘á»ƒ quáº£n lÃ½.",ind:"Saya mencatat tugas di kertas catatan atau kalenderìœ¼ë¡œ untuk mengelolanya."},{id:7,type:'C1',rev:false,kr:"ì—¬ëŸ¬ ì¼ì´ ê²¹ì¹˜ë©´ ì¤‘ìš”í•œ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•œë‹¤.",en:"When I have multiple tasks, I handle them in order of importance.",vn:"Khi cÃ³ nhiá»u viá»‡c, tÃ´i xá»­ lÃ½ theo thá»© tá»± quan trá»ng.",ind:"Ketika ada banyak tugas, saya mengerjakannya sesuai urutan prioritas."},{id:8,type:'C2',rev:false,kr:"ë‚´ ì¼ì€ ì¤‘ê°„ì— ë©ˆì¶”ì§€ ì•Šê³  ëê¹Œì§€ ë§ˆì¹œë‹¤.",en:"I finish my work until the end without stopping halfway.",vn:"TÃ´i hoÃ n thÃ nh cÃ´ng viá»‡c cá»§a mÃ¬nh Ä‘áº¿n cÃ¹ng mÃ  khÃ´ng dá»«ng láº¡i giá»¯a chá»«ng.",ind:"Saya menyelesaikan pekerjaan saya sampai tuntas tanpa berhenti di tengah jalan."},{id:9,type:'C2',rev:true,kr:"ì‘ì€ ì‹¤ìˆ˜ëŠ” ê´€ë¦¬ìì—ê²Œ ë§í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think small mistakes don't need to be reported to the manager.",vn:"TÃ´i nghÄ© nhá»¯ng lá»—i nhá» khÃ´ng cáº§n bÃ¡o cÃ¡o vá»›i quáº£n lÃ½.",ind:"Saya pikir kesalahan kecil tidak perlu dilaporkan kepada manajer."},{id:10,type:'C2',rev:false,kr:"ì‘ì—…ì´ ëë‚˜ë©´ ê²°ê³¼ê°€ ì˜ ë˜ì—ˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸í•œë‹¤.",en:"After checking the work, I re-check if the result is correct.",vn:"Sau khi lÃ m xong, tÃ´i kiá»ƒm tra láº¡i xem káº¿t quáº£ cÃ³ tá»‘t khÃ´ng.",ind:"Setelah selesai bekerja, saya memeriksa kembali apakah hasilnya baik."},{id:11,type:'C2',rev:false,kr:"ì§€ì‹œ ë‚´ìš©ì´ í™•ì‹¤í•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ë¬¼ì–´ë³¸ë‹¤.",en:"If instructions are unclear, I ask again.",vn:"Náº¿u chá»‰ thá»‹ khÃ´ng rÃµ rÃ ng, tÃ´i sáº½ há»i láº¡i.",ind:"Jika instruksi tidak jelas, saya akan bertanya lagi."},{id:12,type:'C2',rev:false,kr:"ë‚´ ì‹¤ìˆ˜ë¡œ ë¬¸ì œê°€ ìƒê¸°ë©´ ë‚´ê°€ ì±…ì„ì§€ê³  í•´ê²°í•œë‹¤.",en:"If a problem occurs due to my mistake, I take responsibility to solve it.",vn:"Náº¿u cÃ³ váº¥n Ä‘á» do lá»—i cá»§a tÃ´i, tÃ´i sáº½ chá»‹u trÃ¡ch nhiá»‡m giáº£i quyáº¿t.",ind:"Jika terjadi masalah akibat kesalahan saya, saya bertanggung jawab menyelesaikannya."},{id:13,type:'C2',rev:false,kr:"í’ˆì§ˆ ê¸°ì¤€ì´ ë†’ì•„ë„ ë§ì¶”ê¸° ìœ„í•´ ë…¸ë ¥í•œë‹¤.",en:"Even if quality standards are high, I try hard to meet them.",vn:"DÃ¹ tiÃªu chuáº©n cháº¥t lÆ°á»£ng cao, tÃ´i váº«n cá»‘ gáº¯ng Ä‘Ã¡p á»©ng.",ind:"Meskipun standar kualitas tinggi, saya berusaha keras memenuhinya."},{id:14,type:'C2',rev:true,kr:"ì¼ì´ ì˜ ì•ˆ ë˜ë©´ ëŒ€ì¶© ë§ˆë¬´ë¦¬í•  ë•Œê°€ ìˆë‹¤.",en:"When work doesn't go well, I sometimes finish it roughly.",vn:"Khi cÃ´ng viá»‡c khÃ´ng thuáº­n lá»£i, Ä‘Ã´i khi tÃ´i lÃ m qua loa.",ind:"Saat pekerjaan tidak lancar, terkadang saya menyelesaikannya dengan asal-asalan."},{id:15,type:'R1',rev:false,kr:"ë‚˜ì˜ ìƒê°ë³´ë‹¤ íšŒì‚¬ì˜ ê·œì¹™ì´ ë” ì¤‘ìš”í•˜ë‹¤.",en:"Company rules are more important than my personal thoughts.",vn:"Quy Ä‘á»‹nh cá»§a cÃ´ng ty quan trá»ng hÆ¡n suy nghÄ© cÃ¡ nhÃ¢n cá»§a tÃ´i.",ind:"Peraturan perusahaan lebih penting daripada pemikiran pribadi saya."},{id:16,type:'R1',rev:true,kr:"ê¸‰í•˜ë©´ ì•ˆì „ ê·œì¹™ì„ ì§€í‚¤ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think safety rules can be skipped if I am in a hurry.",vn:"TÃ´i nghÄ© náº¿u gáº¥p thÃ¬ khÃ´ng cáº§n tuÃ¢n thá»§ quy táº¯c an toÃ n.",ind:"Saya pikir jika terburu-buru, aturan keselamatan boleh tidak diikuti."},{id:17,type:'R1',rev:false,kr:"ì¼í•˜ëŠ” ì¤‘ì—ëŠ” ë‚´ ìë¦¬ë¥¼ ë¹„ìš°ì§€ ì•Šìœ¼ë ¤ í•œë‹¤.",en:"I try not to leave my designated spot while working.",vn:"TÃ´i cá»‘ gáº¯ng khÃ´ng rá»i khá»i vá»‹ trÃ­ khi Ä‘ang lÃ m viá»‡c.",ind:"Saya berusaha tidak meninggalkan tempat saya saat bekerja."},{id:18,type:'R1',rev:false,kr:"ë“¤ì–´ê°€ì§€ ë§ë¼ëŠ” ê³³ì€ ì´ìœ ë¥¼ ëª°ë¼ë„ ì ˆëŒ€ ë“¤ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤.",en:"I never enter restricted areas even if I don't know the reason.",vn:"TÃ´i tuyá»‡t Ä‘á»‘i khÃ´ng vÃ o khu vá»±c cáº¥m dÃ¹ khÃ´ng biáº¿t lÃ½ do.",ind:"Saya khÃ´ng pernah masuk ke area terlarang meskipun saya tidak tahu alasannya."},{id:19,type:'R1',rev:false,kr:"ê´€ë¦¬ìê°€ ì—†ì–´ë„ ê·œì¹™ì„ ì˜ ì§€í‚¨ë‹¤.",en:"I follow rules well even without a manager watching.",vn:"TÃ´i tuÃ¢n thá»§ quy táº¯c ngay cáº£ khi khÃ´ng cÃ³ quáº£n lÃ½.",ind:"Saya mematuhi aturanì™€ith baik meskipun tidak ada manajer."},{id:20,type:'R1',rev:false,kr:"ì¼ì´ ë³µì¡í•´ë„ ì •í•´ì§„ ìˆœì„œëŒ€ë¡œ í•œë‹¤.",en:"Even if the work is complex, I follow the set order.",vn:"DÃ¹ cÃ´ng viá»‡c phá»©c táº¡p, tÃ´i váº«n lÃ m theo trÃ¬nh tá»± quy Ä‘á»‹nh.",ind:"Meskipun pekerjaannya rumit, saya mengikuti urutan yang ditetapkan."},{id:21,type:'R1',rev:true,kr:"ë‹¤ë¥¸ ì‚¬ëŒì´ ê·œì¹™ì„ ì–´ê¸°ë©´, ë‚˜ë„ ë”°ë¼ì„œ ì–´ê¸°ê³  ì‹¶ì–´ì§„ë‹¤.",en:"If others break the rules, I feel like breaking them too.",vn:"Náº¿u ngÆ°á»i khÃ¡c vi pháº¡m quy táº¯c, tÃ´i cÅ©ng muá»‘n lÃ m theo.",ind:"Jika orang lain melanggar aturan, saya juga ingin ikut melanggarnya."},{id:22,type:'R2',rev:false,kr:"ì‹¤ìˆ˜ë‚˜ ì‚¬ê³ ëŠ” ì¦‰ì‹œ ê±°ì§“ ì—†ì´ ë³´ê³ í•´ì•¼ í•œë‹¤.",en:"Mistakes or accidents must be reported immediately and honestly.",vn:"Sai sÃ³t hoáº·c tai náº¡n pháº£i Ä‘Æ°á»£c bÃ¡o cÃ¡o ngay láº­p tá»©c vÃ  trung thá»±c.",ind:"Kesalahan atau kecelakaan harus dilaporkan segera dan jujur."},{id:23,type:'R2',rev:false,kr:"íšŒì‚¬ì˜ ë¬¼ê±´ì„ ê°œì¸ì ìœ¼ë¡œ ê°€ì ¸ê°€ê±°ë‚˜ ì“°ì§€ ì•ŠëŠ”ë‹¤.",en:"I do not take or use company items for personal use.",vn:"TÃ´i khÃ´ng láº¥y hoáº·c sá»­ dá»¥ng Ä‘á»“ cá»§a cÃ´ng ty cho má»¥c Ä‘Ã­ch cÃ¡ nhÃ¢n.",ind:"Saya tidak mengambil atau menggunakan barang perusahaan untuk keperluan pribadi."},{id:24,type:'R2',rev:false,kr:"ê±°ì§“ë§ë¡œ ì‘ì—… ê¸°ë¡ì„ ê¾¸ë©° ë‹¬ë¼ëŠ” ë¶€íƒì€ ê±°ì ˆí•œë‹¤.",en:"I refuse requests to falsify documents.",vn:"TÃ´i tá»« chá»‘i yÃªu cáº§u lÃ m giáº£ tÃ i liá»‡u.",ind:"Saya menolak permintaan untuk memalsukan dokumen."},{id:25,type:'R2',rev:true,kr:"ì¹œí•œ ë™ë£Œê°€ ì˜ëª»í•˜ë©´ ëª¨ë¥¸ ì²™ ë„˜ì–´ê°ˆ ë•Œê°€ ìˆë‹¤.",en:"If a close colleague does wrong, I sometimes pretend not to know.",vn:"Náº¿u Ä‘á»“ng nghiá»‡p thÃ¢n thiáº¿t lÃ m sai, Ä‘Ã´i khi tÃ´i giáº£ vá» khÃ´ng biáº¿t.",ind:"Jika rekan dekat berbuat salah, terkadang saya pura-pura tidak tahu."},{id:26,type:'R2',rev:false,kr:"ë‚´ê°€ ì˜ëª»í–ˆì„ ë•ŒëŠ” ì¸ì •í•˜ê³  ì‚¬ê³¼í•œë‹¤.",en:"When I do wrong, I admit it and apologize.",vn:"Khi tÃ´i lÃ m sai, tÃ´i thá»«a nháº­n vÃ  xin lá»—i.",ind:"Ketika saya salah, saya mengakuinya dan meminta maaf."},{id:27,type:'R2',rev:false,kr:"ë‹¤ë¥¸ ì‚¬ëŒì´ í•œ ì¼ì„ ë‚´ê°€ í–ˆë‹¤ê³  í•˜ì§€ ì•ŠëŠ”ë‹¤.",en:"I do not claim credit for what others have done.",vn:"TÃ´i khÃ´ng nháº­n cÃ´ng lao vá» viá»‡c ngÆ°á»i khÃ¡c Ä‘Ã£ lÃ m.",ind:"Saya khÃ´ng mengklaim pekerjaan orang lain sebagai pekerjaan saya."},{id:28,type:'R2',rev:true,kr:"ê²°ê³¼ê°€ ì¢‹ìœ¼ë©´ ê³¼ì •ì€ ë³´ê³ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think if the result is good, the process doesn't need reporting.",vn:"TÃ´i nghÄ© náº¿u káº¿t quáº£ tá»‘t thÃ¬ khÃ´ng cáº§n bÃ¡o cÃ¡o quÃ¡ trÃ¬nh.",ind:"Saya pikir jika hasilnya bagus, prosesnya tidak perlu dilaporkan."},{id:29,type:'T1',rev:false,kr:"ë™ë£Œê°€ í˜ë“¤ì–´ ë³´ì´ë©´ ë‚´ê°€ ë¨¼ì € ë„ì™€ì¤€ë‹¤.",en:"If a colleague looks tired, I help them first.",vn:"Náº¿u Ä‘á»“ng nghiá»‡p cÃ³ váº» váº¥t váº£, tÃ´i sáº½ giÃºp Ä‘á»¡ trÆ°á»›c.",ind:"Jika rekan kerja terlihat kesulitan, saya akan membantunya terlebih dahulu."},{id:30,type:'T1',rev:false,kr:"ìƒˆë¡œìš´ ì§ì›ì´ ì˜¤ë©´ ë¨¼ì € ë‹¤ê°€ê°€ì„œ ì¼ì„ ì•Œë ¤ì¤€ë‹¤.",en:"When a new employee comes, I approach them first to teach the work.",vn:"Khi cÃ³ nhÃ¢n viÃªn má»›i, tÃ´i chá»§ Ä‘á»™ng Ä‘áº¿n hÆ°á»›ng dáº«n cÃ´ng viá»‡c.",ind:"Saat ada karyawan baru, saya mendekatinya dulu untuk mengajari pekerjaan."},{id:31,type:'T1',rev:false,kr:"íŒ€ì˜ ëª©í‘œë¥¼ ìœ„í•´ì„œë¼ë©´ ë‚´ ì˜ê²¬ì„ ì–‘ë³´í•  ìˆ˜ ìˆë‹¤.",en:"I can give up my opinion for the team's goal.",vn:"TÃ´i cÃ³ thá»ƒ nhÆ°á»ng Ã½ kiáº¿n cá»§a mÃ¬nh vÃ¬ má»¥c tiÃªu cá»§a nhÃ³m.",ind:"Saya bisa mengalah demi tujuan tim."},{id:32,type:'T1',rev:true,kr:"ë‹¤ë¥¸ ì‚¬ëŒì„ ë•ëŠ” ê²ƒì´ ê·€ì°®ê±°ë‚˜ í˜ë“¤ ë•Œê°€ ìˆë‹¤.",en:"Helping others is sometimes annoying or burdensome.",vn:"ÄÃ´i khi viá»‡c giÃºp Ä‘á»¡ ngÆ°á»i khÃ¡c tháº­t phiá»n phá»©c hoáº·c má»‡t má»i.",ind:"Terkadang membantu orang lain terasa merepotkan atau membebani."},{id:33,type:'T1',rev:false,kr:"ëª¨ë¥´ëŠ” ê²ƒì´ ìˆìœ¼ë©´ ë¯¸ë£¨ì§€ ì•Šê³  ë°”ë¡œ ë¬¼ì–´ë³¸ë‹¤.",en:"If I don't know something, I ask immediately without delay.",vn:"Náº¿u khÃ´ng biáº¿t, tÃ´i há»i ngay chá»© khÃ´ng trÃ¬ hoÃ£n.",ind:"Jika tidak tahu, saya langsung bertanya tanpa menunda."},{id:34,type:'T1',rev:false,kr:"ë™ë£Œê°€ ë¬´ì—‡ì„ ì˜í•˜ê³  ë¬´ì—‡ì„ ëª»í•˜ëŠ”ì§€ íŒŒì•…í•˜ë ¤ê³  í•œë‹¤.",en:"I try to understand what my colleagues are good and bad at.",vn:"TÃ´i cá»‘ gáº¯ng náº¯m báº¯t xem Ä‘á»“ng nghiá»‡p giá»iì™€ kÃ©m Ä‘iá»ƒm nÃ o.",ind:"Saya mencoba memahami kelebihan dan kekurangan rekan kerja."},{id:35,type:'T1',rev:false,kr:"ë™ë£Œê°€ ì¼ì„ ì˜í•˜ë©´ ì¹­ì°¬í•´ ì¤€ë‹¤.",en:"I praise my colleagues when they do a good job.",vn:"TÃ´i khen ngá»£i khi Ä‘á»“ng nghiá»‡p lÃ m tá»‘t.",ind:"Saya memuji rekan kerja jika mereka bekerja dengan baik."},{id:36,type:'T2',rev:false,kr:"ìƒëŒ€ì˜ ì˜ê²¬ì´ ë‚˜ì™€ ë‹¬ë¼ë„ ëê¹Œì§€ ë“£ëŠ”ë‹¤.",en:"I listen to others until the end even if their opinion is different.",vn:"TÃ´i láº¯ng nghe Ä‘áº¿n cÃ¹ng dÃ¹ Ã½ kiáº¿n Ä‘á»‘i phÆ°Æ¡ng khÃ¡c tÃ´i.",ind:"Saya mendengarkan sampai selesai meskipun pendapat orang lain berbeda."},{id:37,type:'T2',rev:true,kr:"í™”ê°€ ë‚˜ë©´ ì–¼êµ´ í‘œì •ì— ë°”ë¡œ ë‚˜íƒ€ë‚œë‹¤.",en:"When I am angry, it shows immediately on my face.",vn:"Khi tá»©c giáº­n, nÃ³ hiá»‡n ngay lÃªn nÃ©t máº·t tÃ´i.",ind:"Jika saya marah, itu langsung terlihat di wajah saya."},{id:38,type:'T2',rev:false,kr:"ë™ë£Œì™€ ë¬¸ì œê°€ ìƒê¸°ë©´ í•´ê²° ë°©ë²•ë¶€í„° ì°¾ëŠ”ë‹¤.",en:"If I have a problem with a colleague, I look for a solution first.",vn:"Náº¿u cÃ³ váº¥n Ä‘á» vá»›i Ä‘á»“ng nghiá»‡p, tÃ´i tÃ¬m cÃ¡ch giáº£i quyáº¿t trÆ°á»›c.",ind:"Jika ada masalah dengan rekan kerja, saya mencari solusinya dulu."},{id:39,type:'T2',rev:false,kr:"ë™ë£Œ í—˜ë‹´(ë‚˜ìœ ë§)ì„ í•  ë•Œ ê°™ì´ ë§ì¥êµ¬ì¹˜ì§€ ì•ŠëŠ”ë‹¤.",en:"I do not join in when others speak ill of colleagues.",vn:"TÃ´i khÃ´ng hÃ¹a theo khi ngÆ°á»i khÃ¡c nÃ³i xáº¥u Ä‘á»“ng nghiá»‡p.",ind:"Saya tidak ikut-ikutan saat orang lain menjelekkan rekan kerja."},{id:40,type:'T2',rev:false,kr:"ë‚´ê°€ ì˜ëª»í–ˆì„ ë•ŒëŠ” ë³€ëª…í•˜ì§€ ì•Šê³  ë°”ë¡œ ì‚¬ê³¼í•œë‹¤.",en:"When I am wrong, I apologize immediately without excuses.",vn:"Khi tÃ´i sai, tÃ´i xin lá»—i ngay mÃ  khÃ´ng biá»‡n há»™.",ind:"Saat saya salah, saya langsung minta maaf tanpa alasan."},{id:41,type:'T2',rev:true,kr:"ê¸°ë¶„ì´ ë‚˜ì˜ë©´ ë‚¨ì—ê²Œ ìƒì²˜ ì£¼ëŠ” ë§ì„ í•  ë•Œê°€ ìˆë‹¤.",en:"When I feel bad, I sometimes say hurtful things to others.",vn:"Khi tÃ¢m tráº¡ng tá»“i tá»‡, Ä‘Ã´i khi tÃ´i nÃ³i lá»i gÃ¢y tá»•n thÆ°Æ¡ng cho ngÆ°á»i khÃ¡c.",ind:"Saat suasana hati buruk, terkadang saya mengucapkan kata-kata yang menyakiti orang lain."},{id:42,type:'T2',rev:false,kr:"ë¶„ìœ„ê¸°ê°€ ë‚˜ì˜ë©´ ë§ì„ ì¤„ì´ê³  ìƒí™©ì„ ì‚´í•€ë‹¤.",en:"If the atmosphere is bad, I speak less and observe the situation.",vn:"Náº¿u báº§u khÃ´ng khÃ­ khÃ´ng tá»‘t, tÃ´i nÃ³i Ã­t láº¡iì™€ê´€ sÃ¡t tÃ¬nh hÃ¬nh.",ind:"Jika suasananya buruk, saya mengurangi bicara dan mengamati situasi."},{id:43,type:'E1',rev:false,kr:"ê¾¸ì¤‘ì„ ë“¤ì–´ë„ ê¸°ë¶„ì´ ê¸ˆë°© í’€ë¦°ë‹¤.",en:"Even if I am scolded, I feel better quickly.",vn:"DÃ¹ bá»‹ máº¯ng, tÃ´i cÅ©ng nhanh chÃ³ng láº¥y láº¡i tinh tháº§n.",ind:"Meskipun dimarahi, perasaan saya cepat membaik."},{id:44,type:'E1',rev:true,kr:"ì‘ì€ ì¼ì—ë„ ì‰½ê²Œ í™”ê°€ ë‚œë‹¤.",en:"I get angry easily even at small things.",vn:"TÃ´i dá»… ná»•i giáº­n vÃ¬ nhá»¯ng chuyá»‡n nhá».",ind:"Saya mudah marah bahkan karena hal nhá»."},{id:45,type:'E1',rev:false,kr:"ê¸´ì¥ë˜ëŠ” ìƒí™©ì—ì„œë„ ì¹¨ì°©í•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤.",en:"I try to stay calm even in tense situations.",vn:"TÃ´i cá»‘ gáº¯ng giá»¯ bÃ¬nh tÄ©nh trong tÃ¬nh huá»‘ng cÄƒng tháº³ng.",ind:"Saya berusaha tetap tenang dalam situasi tegang."},{id:46,type:'E1',rev:false,kr:"ì˜ˆë¯¼í•œ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ìˆì–´ë„ ë‚´ ê¸°ë¶„ì„ ì˜ ê´€ë¦¬í•œë‹¤.",en:"I manage my mood well even when with sensitive people.",vn:"TÃ´i quáº£n lÃ½ tá»‘t cáº£m xÃºc cá»§a mÃ¬nh dÃ¹ á»Ÿ cÃ¹ng ngÆ°á»i nháº¡y cáº£m.",ind:"Saya menjaga suasana hati dengan baik meskipun bersama orang sensitif."},{id:47,type:'E1',rev:true,kr:"ê¸°ë¶„ì´ ë‚˜ì˜ë©´ ì¼ì— ì§‘ì¤‘í•˜ê¸° ì–´ë µë‹¤.",en:"It is hard to concentrate on work when I feel bad.",vn:"KhÃ³ táº­p trung lÃ m viá»‡c khi tÃ¢m tráº¡ng khÃ´ng tá»‘t.",ind:"Sulit berkonsentrasi kerja saat perasaan tidak enak."},{id:48,type:'E1',rev:false,kr:"ë‹¤íˆ¼ì´ ìƒê¸°ë©´ ë‚´ í‘œì •ë¶€í„° ê´€ë¦¬í•œë‹¤.",en:"When a fight occurs, I control my facial expression first.",vn:"Khi cÃ³ tranh cÃ£i, tÃ´i quáº£n lÃ½ biá»ƒu cáº£m cá»§a mÃ¬nh trÆ°á»›c.",ind:"Jika terjadi pertengkaran, saya mengontrol ekspresi wajah saya dulu."},{id:49,type:'E1',rev:false,kr:"ë‚´ ê¸°ë¶„ì´ ì•ˆ ì¢‹ì•„ë„ ì¼ì—ëŠ” ì˜í–¥ì´ ì—†ë„ë¡ í•œë‹¤.",en:"I make sure my bad mood doesn't affect my work.",vn:"TÃ´i khÃ´ng Ä‘á»ƒ tÃ¢m tráº¡ng tá»“i tá»‡ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ´ng viá»‡c.",ind:"Saya memastikan suasana hati buruk saya tidak mempengaruhi pekerjaan."},{id:50,type:'E2',rev:false,kr:"ì¼ì´ ë§ì•„ë„ ë‹¹í™©í•˜ì§€ ì•Šê³  í•˜ë‚˜ì”© ìˆœì„œëŒ€ë¡œ í•œë‹¤.",en:"Even with lots of work, I don't panic and do it one by one.",vn:"DÃ¹ nhiá»u viá»‡c, tÃ´i khÃ´ng hoáº£ng há»‘t mÃ  lÃ m tá»«ng viá»‡c theo thá»© tá»±.",ind:"Meskipun banyak kerjaan, saya tidak panik dan mengerjakannya satu per satu."},{id:51,type:'E2',rev:false,kr:"ì‹¤ìˆ˜í•˜ë©´ ë‹¤ì‹œëŠ” ê°™ì€ ì‹¤ìˆ˜ë¥¼ í•˜ì§€ ì•Šìœ¼ë ¤ê³  ë…¸ë ¥í•œë‹¤.",en:"If I make a mistake, I try not to make the same mistake again.",vn:"Náº¿u máº¯c lá»—i, tÃ´i cá»‘ gáº¯ng khÃ´ng láº·p láº¡i lá»—i Ä‘Ã³.",ind:"Jika saya berbuat salah, saya berusaha untuk tidak mengulangi kesalahan yang sama."},{id:52,type:'E2',rev:true,kr:"ì¼ì´ ì˜ ì•ˆ í’€ë¦¬ë©´ ê·¸ë§Œë‘ê³  ì‹¶ì„ ë•Œê°€ ìˆë‹¤.",en:"When work doesn't go well, I sometimes want to quit.",vn:"Khi cÃ´ng viá»‡c khÃ´ng suÃ´n sáº», Ä‘Ã´i khi tÃ´i muá»‘n bá» cuá»™c.",ind:"Saat pekerjaan tidak lancar, terkadang saya ingin berhenti."},{id:53,type:'E2',rev:false,kr:"í˜ë“¤ì–´ë„ ëê¹Œì§€ ì±…ì„ì§€ê³  í•œë‹¤.",en:"Even if it's hard, I take responsibility until the end.",vn:"DÃ¹ khÃ³ khÄƒn, tÃ´i váº«n chá»‹u trÃ¡ch nhiá»‡m Ä‘áº¿n cÃ¹ng.",ind:"Meskipun sulit, saya bertanggung jawab sampai akhir."},{id:54,type:'E2',rev:false,kr:"ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ìœ¼ë©´ ì ì‹œ ì‰¬ê³  ë‹¤ì‹œ ì¼ì— ì§‘ì¤‘í•œë‹¤.",en:"When stressed, I rest a bit and focus on work again.",vn:"Khi cÄƒng tháº³ng, tÃ´i nghá»‰ má»™t lÃ¡t rá»“i táº­p trung láº¡i vÃ o cÃ´ng viá»‡c.",ind:"Saat stres, saya istirahat sebentar lalu fokus kerja lagi."},{id:55,type:'E2',rev:true,kr:"ëª¸ì´ í”¼ê³¤í•˜ë©´ ì¼ì„ ê³„ì†í•˜ê¸° ì–´ë µë‹¤.",en:"It is hard to continue working when my body is tired.",vn:"KhÃ³ tiáº¿p tá»¥c lÃ m viá»‡c khi cÆ¡ thá»ƒ má»‡t má»i.",ind:"Sulit trus bekerja saat badan lelah."},{id:56,type:'E2',rev:false,kr:"ë¨¼ ë¯¸ë˜ë¥¼ ìœ„í•´ ì§€ê¸ˆì˜ ê³ ìƒì„ ì°¸ì„ ìˆ˜ ìˆë‹¤.",en:"I can endure current hardships for the distant future.",vn:"TÃ´i cÃ³ thá»ƒ chá»‹u Ä‘á»±ng váº¥t váº£ hiá»‡n táº¡i vÃ¬ tÆ°Æ¡ng lai xa.",ind:"Saya bisa menahan kesulitan saat ini demi masa depan."},{id:57,type:'S1',rev:false,kr:"ë³´í˜¸êµ¬ê°€ ë¶ˆí¸í•´ë„ ë°˜ë“œì‹œ ì°©ìš©í•œë‹¤.",en:"I always wear safety gear even if it is uncomfortable.",vn:"DÃ¹ Ä‘á»“ báº£o há»™ báº¥t tiá»‡n, tÃ´i váº«n nháº¥t Ä‘á»‹nh pháº£i máº·c.",ind:"Saya selalu memakai alat pelindung meskipun tidak nyaman."},{id:58,type:'S1',rev:true,kr:"ì§§ì€ ì‹œê°„ ì‘ì—…í•  ë•ŒëŠ” ë³´í˜¸êµ¬ë¥¼ ì•ˆ ì¨ë„ ëœë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think safety gear is not needed for short tasks.",vn:"TÃ´i nghÄ© lÃ m viá»‡c thá»i gian ngáº¯n thÃ¬ khÃ´ng cáº§n dÃ¹ng Ä‘á»“ báº£o há»™.",ind:"Saya pikir tidak perlu pakai alat pelindung untuk pekerjaan singkat."},{id:59,type:'S1',rev:false,kr:"ì¼ì˜ ì†ë„ë³´ë‹¤ ì•ˆì „ ê·œì¹™ì´ ë” ì¤‘ìš”í•˜ë‹¤.",en:"Safety rules are more important than work speed.",vn:"Quy táº¯c an toÃ n quan trá»ng hÆ¡n tá»‘c Ä‘á»™ lÃ m viá»‡c.",ind:"Aturan keselamatan lebih penting daripada kecepatan kerja."},{id:60,type:'S1',rev:false,kr:"ì•ˆì „êµìœ¡ ë‚´ìš©ì„ ë– ì˜¬ë¦¬ë ¤ í•œë‹¤.",en:"I work while thinking about what I learned in safety training.",vn:"TÃ´i lÃ m viá»‡c vÃ  nhá»› láº¡i ná»™i dung Ä‘Ã£ há»c trong Ä‘Ã o táº¡o an toÃ n.",ind:"Saya bekerja sambil mengingat apa yang dipelajari dalam pelatihan keselamatan."},{id:61,type:'S1',rev:true,kr:"ê·œì¹™ì´ ë„ˆë¬´ ë§ìœ¼ë©´ ëª‡ ê°œëŠ” ë¬´ì‹œí•´ë„ ëœë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think if there are too many rules, some can be ignored.",vn:"TÃ´i nghÄ© náº¿u cÃ³ quÃ¡ nhiá»u quy táº¯c thÃ¬ cÃ³ thá»ƒ lá» Ä‘i má»™t vÃ i cÃ¡i.",ind:"Saya pikir jika aturannya terlalu banyak, beberapa boleh diabaikan."},{id:62,type:'S1',rev:false,kr:"ì´ìœ ë¥¼ ëª°ë¼ë„ ì•ˆì „ ê·œì¹™ì€ ë¬´ì¡°ê±´ ì§€í‚¨ë‹¤.",en:"I follow safety rules unconditionally even if I don't know the reason.",vn:"DÃ¹ khÃ´ng biáº¿t lÃ½ do, tÃ´i váº«n tuÃ¢n thá»§ quy táº¯c an toÃ n vÃ´ Ä‘iá»u kiá»‡n.",ind:"Saya mematuhi aturan keselamatan tanpa syarat meskipun tidak tahu alasannya."},{id:63,type:'S1',rev:false,kr:"ì‘ì—… ì „ì— ìœ„í—˜í•œ ê²ƒì´ ì—†ëŠ”ì§€ í™•ì¸í•œë‹¤.",en:"I check for any dangers before working.",vn:"TÃ´i kiá»ƒm tra xem cÃ³ gÃ¬ nguy hiá»ƒm khÃ´ng trÆ°á»›c khi lÃ m viá»‡c.",ind:"Saya memeriksa apakah ada bahaya sebelum bekerja."},{id:64,type:'S2',rev:false,kr:"ì‘ì—… ì „ì— ì£¼ë³€ì„ ì˜ ì‚´í´ë³¸ë‹¤.",en:"I look around carefully before working.",vn:"TÃ´i quan sÃ¡t ká»¹ xung quanh trÆ°á»›c khi lÃ m viá»‡c.",ind:"Saya melihat sekelilingì™€n cermat sebelum bekerja."},{id:65,type:'S2',rev:false,kr:"ì¥ë¹„ê°€ ì´ìƒí•˜ë©´ ë°”ë¡œ ë³´ê³ í•œë‹¤.",en:"If the equipment is strange, I report it immediately.",vn:"Náº¿u thiáº¿t bá»‹ cÃ³ váº¥n Ä‘á», tÃ´i bÃ¡o cÃ¡o ngay.",ind:"Jika peralatan aneh, saya segera lapor."},{id:66,type:'S2',rev:true,kr:"ìœ„í—˜í•œ ìƒí™©ì„ ë³„ë¡œ ì¤‘ìš”í•˜ì§€ ì•Šê²Œ ìƒê°í•  ë•Œê°€ ìˆë‹¤.",en:"I sometimes think dangerous situations are not very important.",vn:"ÄÃ´i khi tÃ´i nghÄ© tÃ¬nh huá»‘ng nguy hiá»ƒm khÃ´ng quan trá»ng láº¯m.",ind:"Terkadang saya menganggap situasi berbahaya tidak terlalu penting."},{id:67,type:'S2',rev:false,kr:"ìœ„í—˜í•œ ì‘ì—…ì„ í•˜ê¸° ì „ì—ëŠ” ê¼¼ê¼¼í•˜ê²Œ í™•ì¸í•œë‹¤.",en:"I check thoroughly before doing dangerous work.",vn:"TÃ´i kiá»ƒm tra ká»¹ lÆ°á»¡ng trÆ°á»›c khi lÃ m cÃ´ng viá»‡c nguy hiá»ƒm.",ind:"Saya memeriksa dengan teliti sebelum melakukan pekerjaan berbahaya."},{id:68,type:'S2',rev:false,kr:"ì§€ë‚˜ê°€ëŠ” ê¸¸ì— ë¬¼ê±´ì´ ìˆìœ¼ë©´ ë‚´ê°€ ë¨¼ì € ì¹˜ìš´ë‹¤.",en:"If there are things in the way, I clear them first.",vn:"Náº¿u cÃ³ Ä‘á»“ váº­t Ä‘áº·t á»Ÿ lá»‘i Ä‘i, tÃ´i sáº½ chá»§ Ä‘á»™ng dá»n dáº¹p trÆ°á»›c thay vÃ¬ chá» ngÆ°á»i khÃ¡c.",ind:"Jika ada barang di jalan, saya singkirkan dulu."},{id:69,type:'S2',rev:true,kr:"ì¼í•˜ëŠ” ì¤‘ì— ì¥ë‚œì„ ì¹˜ë©´ ë¶„ìœ„ê¸°ê°€ ì¢‹ì•„ì§„ë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think playing around while working makes the atmosphere better.",vn:"TÃ´i nghÄ© Ä‘Ã¹a giá»¡n trong khi lÃ m viá»‡c sáº½ lÃ m khÃ´ng khÃ­ vui váº» hÆ¡n.",ind:"Saya pikir bercanda saat bekerja membuat suasana lebih baik."},{id:70,type:'S2',rev:false,kr:"ìœ„í—˜ì„ ë°œê²¬í•˜ë©´ ë°”ë¡œ ì‘ì—…ì„ ë©ˆì¶”ê³  ì•Œë¦°ë‹¤.",en:"If I find a danger, I stop work immediately and notify others.",vn:"Náº¿u phÃ¡t hiá»‡n nguy hiá»ƒm, tÃ´i dá»«ng lÃ m viá»‡c ngay vÃ  thÃ´ng bÃ¡o.",ind:"Jika menemukan bahaya, saya langsung berhenti kerja dan memberi tahu."},{id:71,type:'A1',rev:false,kr:"ìƒˆë¡œìš´ ì¼ì´ ì–´ë ¤ì›Œë„ ë°°ìš°ë ¤ê³  ë…¸ë ¥í•œë‹¤.",en:"Even if new work is hard, I try to learn it.",vn:"DÃ¹ viá»‡c má»›i khÃ³, tÃ´i váº«n cá»‘ gáº¯ng há»c.",ind:"Meskipun pekerjaan baru sulit, saya berusaha mempelajarinya."},{id:72,type:'A1',rev:true,kr:"ì¼í•˜ëŠ” ë°©ì‹ì´ ë°”ë€Œë©´ ì²˜ìŒì—ëŠ” ì‹«ì€ ë§ˆìŒì´ ë“ ë‹¤.",en:"When the way of working changes, I dislike it at first.",vn:"Khi cÃ¡ch lÃ m viá»‡c thay Ä‘á»•i, ban Ä‘áº§u tÃ´i tháº¥y khÃ´ng thÃ­ch.",ind:"Saat cara kerja berubah, awalnya saya merasa tidak suka."},{id:73,type:'A1',rev:false,kr:"ë¬¸ì œê°€ ìƒê¸°ë©´ ë¶ˆí‰í•˜ê¸°ë³´ë‹¤ í•´ê²° ë°©ë²•ì„ ì°¾ëŠ”ë‹¤.",en:"When a problem occurs, I look for a solution rather than complaining.",vn:"Khi cÃ³ váº¥n Ä‘á», tÃ´i tÃ¬m cÃ¡ch giáº£i quyáº¿t thay vÃ¬ phÃ n nÃ n.",ind:"Jika ada masalah, saya cari solusi daripada mengeluh."},{id:74,type:'A1',rev:false,kr:"ìƒˆë¡œìš´ ì¥ë¹„ëŠ” ì‚¬ìš©ë²•ì„ ë¨¼ì € ë°°ìš°ê³  ì“´ë‹¤.",en:"I learn how to use new equipment before using it.",vn:"TÃ´i há»c cÃ¡ch sá»­ dá»¥ng thiáº¿t bá»‹ má»›i trÆ°á»›c rá»“i má»›i dÃ¹ng.",ind:"Saya belajar cara pakai alat baru dulu sebelum menggunakannya."},{id:75,type:'A1',rev:false,kr:"ìƒˆë¡œìš´ ë°©ì‹ë³´ë‹¤ ì˜›ë‚  ë°©ì‹ì´ ë” ë‚«ë‹¤ê³  ëŠë‚„ ë•Œê°€ ìˆë‹¤.",en:"I sometimes feel the old way is better than the new way.",vn:"ÄÃ´i khi tÃ´i tháº¥y cÃ¡ch cÅ© tá»‘t hÆ¡n cÃ¡ch má»›i.",ind:"Terkadang saya merasa cara lama lebih baik daripada cara baru."},{id:76,type:'A1',rev:false,kr:"ì‹¤íŒ¨í•´ë„ ë°°ìš°ëŠ” ê²ƒì´ ìˆë‹¤ê³  ìƒê°í•œë‹¤.",en:"I think there is something to learn even if I fail.",vn:"TÃ´i nghÄ© dÃ¹ tháº¥t báº¡i cÅ©ng há»c Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³.",ind:"Saya pikir ada yang bisa dipelajari meski gagal."},{id:77,type:'A1',rev:false,kr:"ì‘ì—… ìƒí™©ì´ ë°”ë€Œì–´ë„ ë¹¨ë¦¬ ì ì‘í•œë‹¤.",en:"I adapt quickly even if the work situation changes.",vn:"TÃ´i thÃ­ch nghi nhanh dÃ¹ tÃ¬nh huá»‘ng cÃ´ng viá»‡c thay Ä‘á»•i.",ind:"Saya cepat beradaptasi meski situasi kerja berubah."},{id:78,type:'A2',rev:false,kr:"ì§€ì‹œ ë‚´ìš©ì„ ì˜ ëª¨ë¥´ë©´ ì•Œ ë•Œê¹Œì§€ ë¬¼ì–´ë³¸ë‹¤.",en:"If I don't understand the instructions, I ask until I know.",vn:"Náº¿u khÃ´ng hiá»ƒu chá»‰ thá»‹, tÃ´i há»i cho Ä‘áº¿n khi hiá»ƒu.",ind:"Jika tidak paham instruksi, saya tanya sampai tahu."},{id:79,type:'A2',rev:false,kr:"ì–¸ì–´ì™€ ë¬¸í™”ê°€ ë‹¬ë¼ë„ ëŒ€í™”í•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤.",en:"Even if language and culture are different, I try to converse.",vn:"DÃ¹ ngÃ´n ngá»¯ vÃ  vÄƒn hÃ³a khÃ¡c biá»‡t, tÃ´i váº«n cá»‘ gáº¯ng trÃ² chuyá»‡n.",ind:"Meskipun bahasa dan budaya berbeda, saya berusaha mengobrol."},{id:80,type:'A2',rev:true,kr:"ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ê²ƒì´ ë¶€ë„ëŸ½ë‹¤.",en:"It is embarrassing to ask for help.",vn:"Viá»‡c yÃªu cáº§u giÃºp Ä‘á»¡ tháº­t xáº¥u há»•.",ind:"Meminta bantuan itu memalukan."},{id:81,type:'A2',rev:false,kr:"ìƒˆë¡œìš´ íŒ€ì— ê°€ë©´ ë¨¼ì € ì¸ì‚¬í•œë‹¤.",en:"When I go to a new team, I greet them first.",vn:"Khi Ä‘áº¿n nhÃ³m má»›i, tÃ´i chÃ o há»i trÆ°á»›c.",ind:"Saat masuk tim baru, saya menyapa duluan."},{id:82,type:'A2',rev:false,kr:"ê·¼ë¬´ ì‹œê°„ì´ ë°”ë€Œì–´ë„ ë¶ˆí‰í•˜ì§€ ì•Šê³  ì ì‘í•œë‹¤.",en:"I adapt without complaint even if work hours change.",vn:"DÃ¹ giá» lÃ m viá»‡c thay Ä‘á»•i, tÃ´i váº«n thÃ­ch nghi khÃ´ng phÃ n nÃ n.",ind:"Meski jam kerja berubah, saya beradaptasi tanpa mengeluh."},{id:83,type:'A2',rev:true,kr:"ìƒˆë¡œìš´ ì‚¬ëŒê³¼ ì¼í•˜ë©´ í”¼ê³¤í•˜ë‹¤.",en:"Working with new people is tiring.",vn:"LÃ m viá»‡c vá»›i ngÆ°á»i má»›i tháº­t má»‡t má»i.",ind:"Bekerja dengan ngÆ°á»i má»›i tháº­t má»‡t má»i."},{id:84,type:'A2',rev:false,kr:"ë‹¤ë¥¸ ë‚˜ë¼ ë™ë£Œì™€ë„ ì˜ ì§€ë‚¸ë‹¤.",en:"I get along well with colleagues from other countries.",vn:"TÃ´i hÃ²a thuáº­n vá»›i Ä‘á»“ng nghiá»‡p nÆ°á»›c khÃ¡c.",ind:"Saya rukun dengan rekan dari negara lain."},{id:85,type:'REL',rev:false,kr:"ë‚˜ëŠ” íƒœì–´ë‚˜ì„œ í•œ ë²ˆë„ ë§ˆê° ì‹œê°„ì„ ì–´ê¸´ ì ì´ ì—†ë‹¤.",en:"I have never missed a deadline in my life.",vn:"TÃ´i chÆ°a bao giá» trá»… háº¡n trong Ä‘á»i.",ind:"Saya tidak pernah melewatkan tenggat waktu seumur hidup saya."},{id:86,type:'REL',rev:false,kr:"ë‚˜ëŠ” íƒœì–´ë‚˜ì„œ í•œ ë²ˆë„ í™”ë¥¼ ë‚¸ ì ì´ ì—†ë‹¤.",en:"I have never gotten angry in my life.",vn:"TÃ´i chÆ°a bao giá» tá»©c giáº­n trong Ä‘á»i.",ind:"Saya tidak pernah marah seumur hidup saya."},{id:87,type:'REL',rev:false,kr:"ë‚˜ëŠ” íƒœì–´ë‚˜ì„œ í•œ ë²ˆë„ ê·œì¹™ì„ ì–´ê¸´ ì ì´ ì—†ë‹¤.",en:"I have never broken a rule in my life.",vn:"TÃ´i chÆ°a bao giá» vi pháº¡m quy táº¯c trong Ä‘á»i.",ind:"Saya tidak pernah melanggar aturan seumur hidup saya."},{id:88,type:'REL',rev:false,kr:"ë‚˜ëŠ” ì§ì¥ì—ì„œ ë™ë£Œì™€ ë‹¤íˆ° ì ì´ í•œ ë²ˆë„ ì—†ë‹¤.",en:"I have never fought with a colleague at work.",vn:"TÃ´i chÆ°a bao giá» cÃ£i nhau vá»›i Ä‘á»“ng nghiá»‡p táº¡i nÆ¡i lÃ m viá»‡c.",ind:"Saya tidak pernah bertengkar dengan rekan kerja di tempat kerja."},{id:89,type:'REL',rev:true,kr:"í•˜ê¸° ì‹«ì–´ì„œ ì¼ì„ ë¯¸ë£° ë•Œê°€ ê°€ë” ìˆë‹¤.",en:"I sometimes put off work because I don't want to do it.",vn:"ÄÃ´i khi tÃ´i hoÃ£n cÃ´ng viá»‡c vÃ¬ khÃ´ng muá»‘n lÃ m.",ind:"Terkadang saya menunda pekerjaan karena malas."},{id:90,type:'REL',rev:true,kr:"ê¸°ë¶„ì´ ì•ˆ ì¢‹ìœ¼ë©´ ë§ì„ ì•ˆ í•  ë•Œê°€ ìˆë‹¤.",en:"I sometimes don't speak when I feel bad.",vn:"Khi tÃ¢m tráº¡ng khÃ´ng tá»‘t, Ä‘Ã´i khi tÃ´i khÃ´ng nÃ³i chuyá»‡n.",ind:"Terkadang saya diam saat perasaan tidak enak."},{id:91,type:'REL',rev:true,kr:"ë‚˜ì™€ ì„±ê²©ì´ ì•ˆ ë§ëŠ” ì‚¬ëŒê³¼ ì¼í•˜ëŠ” ê²ƒì€ ë¶ˆí¸í•˜ë‹¤.",en:"It is uncomfortable to work with someone who doesn't match my personality.",vn:"LÃ m viá»‡c vá»›i ngÆ°á»i khÃ´ng há»£p tÃ­nh cÃ¡ch tháº­t khÃ´ng thoáº£i mÃ¡i.",ind:"Tidak nyaman bekerja dengan orang yang tidak cocok sifatnya."},{id:92,type:'REL',rev:true,kr:"ë‚´ ì‹¤ìˆ˜ë¥¼ ì¸ì •í•˜ëŠ” ê²ƒì´ ë§ˆìŒ ë¶ˆí¸í•  ë•Œê°€ ìˆë‹¤.",en:"Admitting my mistakes is sometimes uncomfortable.",vn:"Thá»«a nháº­n lá»—i láº§m cá»§a mÃ¬nh Ä‘Ã´i khi tháº¥y khÃ³ chá»‹u.",ind:"Mengakui kesalahan terkadang terasa tidak nyaman."},{id:93,type:'REL',rev:false,kr:"ë‚˜ëŠ” í•˜ë£¨ ì¢…ì¼ ì¼í•´ë„ ì „í˜€ í”¼ê³¤í•˜ì§€ ì•Šë‹¤.",en:"I am not tired at all even if I work all day.",vn:"TÃ´i khÃ´ng há» má»‡t má»i dÃ¹ lÃ m viá»‡c cáº£ ngÃ y.",ind:"Saya sama sekali tidak lelah meski kerja seharian."},{id:94,type:'REL',rev:false,kr:"ì¼ì´ ì•„ë¬´ë¦¬ í˜ë“¤ì–´ë„ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ì „í˜€ ë°›ì§€ ì•ŠëŠ”ë‹¤.",en:"I don't get stressed at all no matter how hard the work is.",vn:"TÃ´i hoÃ n toÃ n khÃ´ng bá»‹ cÄƒng tháº³ng dÃ¹ cÃ´ng viá»‡c váº¥t váº£ tháº¿ nÃ o.",ind:"Saya sama sekali tidak stres seberat apa pun pekerjaannya."}];
var MGMT_GUIDE={'C1':{title:"ê·¼íƒœÂ·ì‹œê°„",desc:"ì‹œê°„ ì—„ìˆ˜"},'C2':{title:"ì±…ì„ê°",desc:"í’ˆì§ˆÂ·ì™„ìˆ˜"},'R1':{title:"ê·œì • ì¤€ìˆ˜",desc:"ê·œì¹™ ì´í–‰"},'R2':{title:"ì •ì§ì„±",desc:"íˆ¬ëª…í•œ ë³´ê³ "},'T1':{title:"í˜‘ë ¥ íƒœë„",desc:"íŒ€ì›Œí¬"},'T2':{title:"ê°ˆë“± ê´€ë¦¬",desc:"ëŒ€ì¸ ê´€ê³„"},'E1':{title:"ê°ì • ì¡°ì ˆ",desc:"í‰ì •ì‹¬"},'E2':{title:"ì¸ë‚´ì‹¬",desc:"ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬"},'S1':{title:"ì•ˆì „ ìˆ˜ì¹™",desc:"ë³´í˜¸êµ¬ ì°©ìš©"},'S2':{title:"ìœ„í—˜ ì¸ì§€",desc:"ì‚¬ì „ ì˜ˆë°©"},'A1':{title:"í•™ìŠµ ëŠ¥ë ¥",desc:"ì—…ë¬´ ìŠµë“"},'A2':{title:"ì¡°ì§ ì ì‘",desc:"ê´€ê³„Â·ë¬¸í™”"}};
let currentLang='',currentQIndex=0,userAnswers={},candidateData={};let timerInterval=null,remainingTime=1800,chartInstance=null;let globalLocalData=[],globalFileData=[],currentSearch="",currentFilter="ALL";let sortKey='date',sortOrder='desc';let currentViewingData=null;const LOCAL_DB_KEY='HD_E7_FINAL_V30';let isNavigating=false;let deleteCallback=null;let shuffledIndices=[]; // [ëœë¤] ì…”í”Œ ì¸ë±ìŠ¤ ì €ì¥ìš©
window.showConfirm=function(m,c){document.getElementById('confirm-message').textContent=m;deleteCallback=c;document.getElementById('confirm-modal').classList.remove('hidden')};
document.getElementById('confirm-yes-btn').onclick=function(){if(deleteCallback)deleteCallback();document.getElementById('confirm-modal').classList.add('hidden');deleteCallback=null};
function getYYYYMMDD(d){if(!d)return'-';const o=new Date(d);if(!isNaN(o))return`${o.getFullYear()}.${String(o.getMonth()+1).padStart(2,'0')}.${String(o.getDate()).padStart(2,'0')}`;const m=d.match(/(\d{4})[./-]\s?(\d{1,2})[./-]\s?(\d{1,2})/);return m?`${m[1]}.${m[2].padStart(2,'0')}.${m[3].padStart(2,'0')}`:d.split(' ')[0]}
window.switchView=function(id){document.querySelectorAll('[id^="view-"]').forEach(el=>el.classList.add('hidden'));document.getElementById('view-report').classList.remove('active');const el=document.getElementById(id);if(el){el.classList.remove('hidden');if(id==='view-report')el.classList.add('active');updateReportScale()}};
window.selectLang=function(l){currentLang=l;document.querySelectorAll('.lang-btn-premium').forEach(b=>b.classList.remove('active'));const b=document.getElementById('btn-'+l);if(b)b.classList.add('active')};
window.goToLogin=function(){window.switchView('view-login')};
window.resetToHome=function(){currentQIndex=0;userAnswers={};candidateData={};remainingTime=1800;if(timerInterval)clearInterval(timerInterval);document.getElementById('input-name').value='';document.getElementById('input-id').value='';document.querySelectorAll('.likert-input').forEach(i=>i.checked=false);document.getElementById('progress-bar').style.width='0%';currentLang='';document.querySelectorAll('.lang-btn-premium').forEach(b=>b.classList.remove('active'));updateStoredCount();localStorage.removeItem('E7_SHUFFLED_ORDER');window.switchView('view-home')}; // [ëœë¤] ì…”í”Œ ì´ˆê¸°í™” ì¶”ê°€
function updateStoredCount(){const db=JSON.parse(localStorage.getItem(LOCAL_DB_KEY)||'[]');document.getElementById('stored-count').textContent=db.length}
window.checkUrlAndStart=function(){window.switchView('view-login')};
window.showModal=function(m){document.getElementById('modal-message').innerHTML=m.replace(/\n/g,'<br>');document.getElementById('custom-modal').classList.remove('hidden')};
window.closeModal=function(){document.getElementById('custom-modal').classList.add('hidden')};
window.showGuide=function(){const n=document.getElementById('input-name').value;const i=document.getElementById('input-id').value;if(!currentLang||!n||!i)return showModal("ì •ë³´ ì…ë ¥ ë° ì–¸ì–´ ì„ íƒì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.");candidateData={name:n,id:i,startTime:new Date().toLocaleString()};const t=GUIDE_TEXTS[currentLang]||GUIDE_TEXTS['kr'];document.getElementById('guide-title').textContent=t.title;document.getElementById('guide-time').textContent=t.timeVal;document.getElementById('guide-count').textContent=t.countVal;document.getElementById('guide-warn').innerHTML=t.warnVal;document.getElementById('guide-btn').textContent=t.btn;window.switchView('view-guide')};
window.startRealTest=function(){
    const temp = localStorage.getItem('E7_TEMP_DATA');
    const storedOrder = localStorage.getItem('E7_SHUFFLED_ORDER'); // [ëœë¤] ì €ì¥ëœ ìˆœì„œ í™•ì¸
    if (temp) {
        if (confirm("ì´ì „ì— ì§„í–‰ ì¤‘ì´ë˜ ê²€ì‚¬ ë‚´ì—­ì´ ìˆìŠµë‹ˆë‹¤. ì´ì–´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            try {
                const parsed = JSON.parse(temp);
                userAnswers = parsed.answers || {};
                currentQIndex = parsed.idx || 0;
                remainingTime = parsed.time || 1800;
                if(parsed.info) candidateData = parsed.info;
                if(storedOrder) shuffledIndices = JSON.parse(storedOrder); // [ëœë¤] ê¸°ì¡´ ìˆœì„œ ë¡œë“œ
                else { shuffledIndices = Array.from({length: QUESTIONS_FULL.length}, (_, i) => i); } // fallback
                window.switchView('view-assessment');
                loadQuestion(currentQIndex);
                startTimer();
                return;
            } catch(e) { localStorage.removeItem('E7_TEMP_DATA'); }
        } else {
            localStorage.removeItem('E7_TEMP_DATA');
            localStorage.removeItem('E7_SHUFFLED_ORDER'); // [ëœë¤] ì·¨ì†Œ ì‹œ ìˆœì„œë„ ì´ˆê¸°í™”
        }
    }
    // [ëœë¤] ìƒˆë¡œìš´ ì…”í”Œ ìƒì„±
    shuffledIndices = Array.from({length: QUESTIONS_FULL.length}, (_, i) => i);
    for (let i = shuffledIndices.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledIndices[i], shuffledIndices[j]] = [shuffledIndices[j], shuffledIndices[i]];
    }
    localStorage.setItem('E7_SHUFFLED_ORDER', JSON.stringify(shuffledIndices));
    
    window.switchView('view-assessment');
    loadQuestion(0);
    startTimer();
    window.addEventListener('beforeunload', preventExit);
};
function preventExit(e){e.preventDefault();e.returnValue='';}
function startTimer(){const d=document.getElementById('timer-display');timerInterval=setInterval(()=>{remainingTime--;d.textContent=`${String(Math.floor(remainingTime/60)).padStart(2,'0')}:${String(remainingTime%60).padStart(2,'0')}`;if(remainingTime<=0){clearInterval(timerInterval);window.finishAssessment()}},1000)}
function loadQuestion(idx){
    if(idx>=QUESTIONS_FULL.length)return window.finishAssessment();
    currentQIndex=idx;
    const realIdx = shuffledIndices[idx]; // [ëœë¤] ì‹¤ì œ ë¬¸í•­ ì¸ë±ìŠ¤ ì¡°íšŒ
    const q=QUESTIONS_FULL[realIdx];
    let txt=q.kr;if(currentLang==='vn')txt=q.vn;else if(currentLang==='en')txt=q.en;else if(currentLang==='id')txt=q.ind;document.getElementById('q-text-native').textContent=`${idx+1}. ${txt}`;document.getElementById('q-text-kr').textContent=q.kr;const labels={'vn':['HoÃ n toÃ n khÃ´ng Ä‘á»“ng Ã½','KhÃ´ng Ä‘á»“ng Ã½','BÃ¬nh thÆ°á»ng','Äá»“ng Ã½','HoÃ n toÃ n Ä‘á»“ng Ã½'],'kr':['ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤','ê·¸ë ‡ì§€ ì•Šì€ í¸ì´ë‹¤','ë³´í†µì´ë‹¤','ê·¸ëŸ° í¸ì´ë‹¤','ë§¤ìš° ê·¸ë ‡ë‹¤'],'en':['Strongly Disagree','Disagree','Neutral','Agree','Strongly Agree'],'id':['Sangat Tidak Setuju','Tidak Setuju','Netral','Setuju','Sangat Setuju']};const l=labels[currentLang]||labels.kr;const container=document.getElementById('likert-container');container.innerHTML='';for(let i=1;i<=5;i++){container.innerHTML+=`<div class="col-span-1 flex flex-col items-center cursor-pointer group select-none py-2" onclick="window.chooseAnswer(${i})"><input type="radio" name="q_answer" id="ans_${i}" value="${i}" class="likert-input hidden" ${userAnswers[q.id]==i?'checked':''}><label for="ans_${i}" class="w-10 h-10 md:w-14 md:h-14 lg:w-16 lg:h-16 responsive-circle rounded-full border-2 border-slate-200 flex items-center justify-center text-lg md:text-xl lg:text-2xl font-black text-slate-300 transition-all cursor-pointer group-hover:border-blue-400 group-hover:text-blue-500 bg-white shadow-sm mb-2 md:mb-3">${i}</label><span class="text-[11px] md:text-sm lg:text-base text-center text-slate-500 font-bold leading-tight font-kor break-keep group-hover:text-blue-900 transition-colors px-1">${l[i-1]}</span></div>`}document.getElementById('current-q-num').textContent=idx+1;document.getElementById('progress-bar').style.width=`${((idx)/94)*100}%`;document.getElementById('header-btn-prev').classList.toggle('hidden',idx===0);document.getElementById('btn-submit').classList.toggle('hidden',idx<93);isNavigating=false
}
window.chooseAnswer=function(v){
    if (isNavigating) return;
    isNavigating = true;
    const realIdx = shuffledIndices[currentQIndex]; // [ëœë¤] ì‹¤ì œ ID ë§¤í•‘
    const q = QUESTIONS_FULL[realIdx];
    userAnswers[q.id] = v; // [ëœë¤] ì›ë³¸ IDë¡œ ì €ì¥
    localStorage.setItem('E7_TEMP_DATA', JSON.stringify({
        answers: userAnswers,
        idx: currentQIndex,
        time: remainingTime,
        info: candidateData
    }));
    if(currentQIndex<93)setTimeout(()=>loadQuestion(currentQIndex+1),250);
    else{isNavigating=false;loadQuestion(currentQIndex)}
};
window.prevQuestion=function(){if(currentQIndex>0){isNavigating=false;loadQuestion(currentQIndex-1)}};
window.finishAssessment=async function(){
    const realIdx = shuffledIndices[currentQIndex];
    const lastQ = QUESTIONS_FULL[realIdx];
    if(!userAnswers[lastQ.id])return showModal("ë§ˆì§€ë§‰ ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.");
    window.removeEventListener('beforeunload', preventExit);
    
    const elapsedTime = 1800 - remainingTime;
    clearInterval(timerInterval);
    
    document.body.style.pointerEvents = 'none';
    window.switchView('view-upload');
    
    const result=calculateAll(candidateData.name,userAnswers);
    if (elapsedTime < 300) {
        if(result.reliability.includes('V1') || result.reliability.includes('V2')) {
            result.reliability = 'ì£¼ì˜ (V3) - ì‹œê°„ë¯¸ë‹¬';
        }
        result.isTooFast = true;
    }
    result.id=candidateData.id;
    result.date=candidateData.startTime;
    result.source="ê¸°ê¸° ì§ì ‘ ì‘ì‹œ";
    saveLocal(result);
    localStorage.removeItem('E7_TEMP_DATA');
    localStorage.removeItem('E7_SHUFFLED_ORDER'); // [ëœë¤] ì™„ë£Œ ì‹œ ìˆœì„œ ì´ˆê¸°í™”
    if(GOOGLE_SCRIPT_URL){
        try{
            const sheetPayload = {
                date: result.date, name: result.name, id: result.id, source: result.source,
                total: result.total, reliability: result.reliability, decision: result.decision, minScore: result.minScore
            };
            Object.assign(sheetPayload, result.details);
            for(let i=1; i<=94; i++){ sheetPayload['Q'+i] = result.answers[i] || ''; }
            await fetch(GOOGLE_SCRIPT_URL,{ method:'POST', mode:'no-cors', body:JSON.stringify(sheetPayload) });
        }catch(e){}
    }
    document.body.style.pointerEvents = 'auto';
    setTimeout(()=>window.switchView('view-thankyou'),1500)
};
window.showAdminLogin=function(){window.switchView('view-admin-login')};
window.checkAdminPw=function(){if(document.getElementById('admin-pw').value==="3269"){const local=JSON.parse(localStorage.getItem(LOCAL_DB_KEY)||'[]');globalLocalData=local.map(d=>({...d,source:"ê¸°ê¸° ì €ì¥"}));renderDashboard();window.switchView('view-admin-dashboard')}else showModal("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜")};
window.downloadLocalData=function(){const db=JSON.parse(localStorage.getItem(LOCAL_DB_KEY)||'[]');if(db.length===0)return alert("ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");const d=db[db.length-1];const a=document.createElement('a');a.href="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(d));a.download=`E7_Result_${d.name}_${d.id}.json`;document.body.appendChild(a);a.click();a.remove()};
window.downloadTableAsExcel=function(){
    const data = [...globalLocalData, ...globalFileData];
    if(data.length===0) return showModal("ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
    const exportData = data.map(d => {
        const row = { 'Source': d.source, 'Name': d.name, 'ID': d.id, 'Date': getYYYYMMDD(d.date), 'Total Score': d.total, 'Grade': d.decision, 'Reliability': d.reliability, 'Min Score': d.minScore };
        Object.assign(row, d.details);
        return row;
    });
    const ws = XLSX.utils.json_to_sheet(exportData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Assessment_Results");
    XLSX.writeFile(wb, `HD_E7_Results_ALL_${new Date().toISOString().slice(0,10)}.xlsx`);
};
window.handleFileUpload = function(input) {
  const f = input.files[0];
  if (!f) return;
  if (f.name.toLowerCase().endsWith('.json')) {
    const r = new FileReader();
    r.onload = (e) => {
      try { const j = JSON.parse(e.target.result); (Array.isArray(j) ? j : [j]).forEach(d => { d.source = "íŒŒì¼ ë°±ì—… (JSON)"; globalFileData.push(d); }); renderDashboard(); alert("ë°±ì—… íŒŒì¼ ë¡œë“œ ì™„ë£Œ"); } catch (e) { alert("JSON íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."); }
    };
    r.readAsText(f);
  } else {
    const r = new FileReader();
    r.onload = (e) => {
      const wb = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
      const rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], { header: 1, raw: false, dateNF: 'yyyy-mm-dd' });
      let hIdx = rows.findIndex(r => r && r.some(c => c && c.toString().replace(/\s/g, '').match(/(ì¢…í•©ì ìˆ˜|ì´ì |Total)/i)));
      if (hIdx !== -1) {
        const headers = rows[hIdx];
        const find = (k) => headers.findIndex(h => h && k.some(x => h.toString().replace(/\s/g, '').toUpperCase().includes(x.toUpperCase())));
        const findExact = (target) => headers.findIndex(h => { if (!h) return false; const cellStr = h.toString().replace(/\s/g, '').toUpperCase(); const targetStr = String(target).toUpperCase(); return cellStr === targetStr; });
        const map = { name: find(['ì„±ëª…', 'ì´ë¦„', 'Name']), id: find(['ID', 'ì‘ì‹œë²ˆí˜¸', 'Candidate']), total: find(['ì¢…í•©ì ìˆ˜', 'ì´ì ', 'Total']), rel: find(['ì‹ ë¢°ë„', 'Reliability']), dec: find(['íŒì •', 'ë“±ê¸‰', 'ì¢…í•©ë“±ê¸‰', 'Grade', 'Decision']), date: find(['ì¼ì‹œ', 'ë‚ ì§œ', 'Date', 'Time', 'ì‘ì‹œì¼ì']) };
        for (let i = hIdx + 1; i < rows.length; i++) {
          const row = rows[i];
          if (!row || !row[map.name]) continue;
          let det = {}; ['C1', 'C2', 'R1', 'R2', 'T1', 'T2', 'E1', 'E2', 'S1', 'S2', 'A1', 'A2'].forEach(k => { const idx = find([k]); if (idx !== -1) det[k] = parseFloat(row[idx] || 0); });
          let answers = {}; for (let q = 1; q <= 94; q++) { let qIdx = findExact(q); if (qIdx === -1) qIdx = findExact('Q' + q); if (qIdx === -1) qIdx = findExact('ë¬¸í•­' + q); if (qIdx !== -1) { let val = parseInt(row[qIdx]); if (!isNaN(val) && val >= 1 && val <= 5) { answers[q] = val; } } }
          globalFileData.push({ source: "ì—‘ì…€ ì—…ë¡œë“œ", name: row[map.name], id: row[map.id] || '-', total: parseFloat(row[map.total] || 0), reliability: row[map.rel] || '-', decision: row[map.dec] || '-', details: det, minScore: Math.min(...Object.values(det)), date: map.date !== -1 ? row[map.date] : new Date().toLocaleString(), answers: answers });
        }
        renderDashboard(); alert("ì—‘ì…€ ë°ì´í„° ë¡œë“œ ì™„ë£Œ");
      } else { showModal("ì—‘ì…€ í˜•ì‹ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); }
    };
    r.readAsArrayBuffer(f);
  }
};
window.showQRCode=function(){document.getElementById('qr-url-input').value=window.location.href;document.getElementById('qr-modal').classList.remove('hidden');window.generateQRFromInput()};
window.generateQRFromInput=function(){const c=document.getElementById('qrcode-display');c.innerHTML='';new QRCode(c,{text:document.getElementById('qr-url-input').value,width:300,height:300,colorDark:"#002c5f",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})};
function saveLocal(d){const db=JSON.parse(localStorage.getItem(LOCAL_DB_KEY)||'[]');db.push(d);localStorage.setItem(LOCAL_DB_KEY,JSON.stringify(db))}
window.handleSearch=function(v){currentSearch=v.toLowerCase().trim();renderDashboard()};
window.setFilter=function(g){currentFilter=g;document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));document.getElementById('filter-'+g)?.classList.add('active');renderDashboard()};
window.deleteItem=function(s,id,d){window.showConfirm("ì„ íƒí•œ í•­ëª©ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",()=>{try{if(s==='ê¸°ê¸° ì €ì¥'){globalLocalData=globalLocalData.filter(i=>!(String(i.id)===String(id)&&String(i.date)===String(d)));localStorage.setItem(LOCAL_DB_KEY,JSON.stringify(globalLocalData.map(({source,...r})=>r)));renderDashboard()}else if(s.includes('íŒŒì¼')||s==='ì—‘ì…€ ì—…ë¡œë“œ'){globalFileData=globalFileData.filter(i=>!(String(i.id)===String(id)&&String(i.date)===String(d)));renderDashboard()}else window.showModal("ì‚­ì œí•  ìˆ˜ ì—†ëŠ” ë°ì´í„° ì†ŒìŠ¤ì…ë‹ˆë‹¤.")}catch(e){window.showModal("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+e.message)}})};
window.handleSort=function(k){if(sortKey===k)sortOrder=sortOrder==='asc'?'desc':'asc';else{sortKey=k;sortOrder='desc'}renderDashboard()};
function renderDashboard(){const tb=document.getElementById('dashboard-tbody');tb.innerHTML='';let data=[...globalLocalData,...globalFileData];if(currentSearch)data=data.filter(d=>(d.name&&d.name.toLowerCase().includes(currentSearch))||(d.id&&d.id.toLowerCase().includes(currentSearch)));if(currentFilter!=='ALL')data=data.filter(d=>d.decision&&d.decision.includes(currentFilter));data.sort((a,b)=>{let va=a[sortKey],vb=b[sortKey];if(sortKey==='total'){va=parseFloat(va||0);vb=parseFloat(vb||0)}else if(sortKey==='date'){va=new Date(va).getTime();vb=new Date(vb).getTime()}else{va=String(va||'').toLowerCase();vb=String(vb||'').toLowerCase()}return va<vb?(sortOrder==='asc'?-1:1):(va>vb?(sortOrder==='asc'?1:-1):0)});['source','name','id','date','total','reliability','decision'].forEach(k=>{const el=document.getElementById('sort-arrow-'+k);if(el){el.textContent=k===sortKey?(sortOrder==='asc'?'â–²':'â–¼'):'';el.parentElement.classList.toggle('text-blue-600',k===sortKey)}});data.forEach((r)=>{const tr=document.createElement('tr');tr.className="border-b hover:bg-blue-50 cursor-pointer transition-colors";tr.innerHTML=`<td class="px-4 py-4 text-xs font-bold text-slate-400 font-eng col-source whitespace-normal leading-tight">${r.source==='ê¸°ê¸° ì €ì¥'?'<span class="text-slate-400">ğŸ“± LOCAL</span>':(r.source.includes('íŒŒì¼')?'<span class="text-green-600 font-bold">ğŸ“‚ FILE</span>':r.source)}</td><td class="px-4 py-4 font-black text-gray-900 font-kor text-base col-name whitespace-normal break-words leading-snug">${r.name}</td><td class="px-4 py-4 font-bold text-gray-600 font-eng col-id whitespace-normal break-all leading-snug">${r.id}</td><td class="px-4 py-4 text-xs font-medium text-gray-500 font-eng col-date whitespace-normal leading-tight">${getYYYYMMDD(r.date)}</td><td class="px-4 py-4 font-black text-center font-eng text-lg text-blue-900 col-score">${r.total}</td><td class="px-4 py-4 text-xs text-center font-bold font-kor col-rel whitespace-normal leading-tight">${r.reliability}</td><td class="px-4 py-4 text-center col-grade"><span class="px-3 py-1 rounded-full text-xs font-black shadow-sm bg-blue-100 text-blue-700 whitespace-nowrap">${r.decision}</span></td><td class="px-4 py-4 text-xs text-center text-blue-600 font-black hover:underline col-action">VIEW ></td><td class="px-4 py-4 text-center col-action"><button class="text-slate-400 hover:text-red-600 transition-colors p-2 rounded-full hover:bg-red-50 delete-btn" title="ì‚­ì œ">ğŸ—‘ï¸</button></td>`;Array.from(tr.children).slice(0,-1).forEach(td=>td.onclick=()=>window.showReport(r));tr.querySelector('.delete-btn').onclick=(e)=>{e.stopPropagation();window.deleteItem(r.source,r.id,r.date)};tb.appendChild(tr)});document.getElementById('db-count-badge').textContent=data.length;updateStoredCount()}
window.openGoogleSheet=function(){window.open("https://docs.google.com/spreadsheets","_blank")};
function calculateAll(name, map) {
    const s = {C1:0,C2:0,R1:0,R2:0,S1:0,S2:0,T1:0,T2:0,E1:0,E2:0,A1:0,A2:0};
    const c = {C1:0,C2:0,R1:0,R2:0,S1:0,S2:0,T1:0,T2:0,E1:0,E2:0,A1:0,A2:0};
    const ansArr = [];
    Object.keys(map).sort((a,b)=>a-b).forEach(k => ansArr.push(map[k]));
    QUESTIONS_FULL.forEach(q => {
        if (map[q.id] !== undefined && q.type !== 'REL') {
            const raw = map[q.id];
            const val = q.rev ? (6 - raw) : raw;
            const norm = ((val - 1) / 4) * 100;
            s[q.type] += norm;
            c[q.type]++;
        }
    });
    const sub = {};
    Object.keys(c).forEach(k => sub[k] = c[k] > 0 ? Math.round(s[k] / c[k]) : 0);
    const main = {
        C: Math.round((sub.C1 + sub.C2) / 2),
        R: Math.round((sub.R1 + sub.R2) / 2),
        S: Math.round((sub.S1 + sub.S2) / 2),
        T: Math.round((sub.T1 + sub.T2) / 2),
        E: Math.round((sub.E1 + sub.E2) / 2),
        A: Math.round((sub.A1 + sub.A2) / 2)
    };
    const total = Math.round((main.C * 0.8 + main.R * 0.8 + main.S * 1.4) / 3);
    const crit = [sub.C1, sub.C2, sub.R1, sub.R2, sub.S1, sub.S2];
    const sFail = sub.S1 < 60 || sub.S2 < 60;
    const failCnt = crit.filter(v => v < 60).length;
    const isCritFail = sFail || (failCnt >= 2);
    let rG = 'V1';
    let l1 = [85, 86, 87, 88].filter(i => map[i] >= 4).length; 
    let l2 = [93, 94].filter(i => map[i] === 5).length;       
    const kCnt = Object.values(map).filter(v => v === 3).length;
    const fCnt = Object.values(map).filter(v => v === 1 || v === 5).length;
    let maxC = 1, curC = 1;
    if (ansArr.length > 0) {
        let p = ansArr[0];
        for (let i = 1; i < ansArr.length; i++) {
            if (ansArr[i] === p) { curC++; maxC = Math.max(maxC, curC); } 
            else { p = ansArr[i]; curC = 1; }
        }
    }
    if (l1 >= 3) rG = 'V2';
    if (l2 >= 1) rG = 'V2';
    if (kCnt >= 65) rG = 'V3';
    if (fCnt >= 75) rG = 'V3';
    if (l1 === 4) rG = 'V3';
    if (l2 === 2) rG = 'V3';
    if (maxC >= 15) rG = 'V3';
    if (maxC >= 30) rG = 'V4';
    if (maxC >= 90) rG = 'V5';
    let dec = 'B1';
    if (rG === 'V4' || rG === 'V5') { dec = 'D'; } 
    else if (rG === 'V3') {
        if (total >= 85 && !isCritFail) dec = 'B1';
        else dec = 'C';
    }
    else if (isCritFail) { dec = 'C'; } 
    else if (total >= 91 && (rG === 'V1' || rG === 'V2') && main.R >= 88 && main.S >= 88 && !isCritFail) { dec = 'S'; } 
    else if (total >= 81 && (rG === 'V1' || rG === 'V2')) { dec = 'A'; } 
    else if (total < 66) { dec = 'B2'; } 
    else { dec = 'B1'; }
    const gMap = { S: 'ìµœìš°ìˆ˜ (S)', A: 'ìš°ìˆ˜ (A)', B1: 'ë³´í†µ (B1)', B2: 'ë³´í†µ (B2)', C: 'ì£¼ì˜ (C)', D: 'ë¶€ì í•© (D)' };
    const rMap = { V1: 'ë†’ìŒ (V1)', V2: 'ë³´í†µ (V2)', V3: 'ì£¼ì˜ (V3)', V4: 'ë‚®ìŒ (V4)', V5: 'ë§¤ìš° ë‚®ìŒ (V5)' };
    return {
        name, total, reliability: rMap[rG] || rG, decision: gMap[dec] || dec, details: sub, mainDetails: main, minScore: Math.min(...crit), answers: map,
        diagnosis: { l1: l1, l2: l2, maxC: maxC, sFail: sFail, failCnt: failCnt }
    };
}
async function generateAIAnalysis(d) {
    const btn = document.getElementById('btn-ai-generate');
    const con = document.getElementById('ai-result-container');
    if (!btn || !con) return;
    btn.innerHTML = 'âœ¨ AI ë¶„ì„ ì¤‘... (ì•½ 10ì´ˆ)';
    btn.disabled = true;
    btn.classList.add('opacity-50');
    try {
        let sRes = "";
        if (d.answers) {
            const items = [];
            // [ë³€ê²½] ëª¨ë“  ì‘ë‹µ ëŒ€ì‹ , ê·¹ë‹¨ì  ë‹µë³€(1ì /5ì )ë§Œ ì¶”ì¶œí•˜ì—¬ í”„ë¡¬í”„íŠ¸ì— í¬í•¨
            Object.entries(d.answers).forEach(([qid, v]) => {
                const q = QUESTIONS_FULL.find(q => q.id == qid);
                if (q && (v == 1 || v == 5) && q.type !== 'REL') {
                    // [ë³€ê²½] ë¬¸í•­ IDì™€ ë‚´ìš©ì„ í•¨ê»˜ ì „ë‹¬í•˜ì—¬ AIê°€ êµ¬ì²´ì ìœ¼ë¡œ íŒŒì•…í•˜ë„ë¡ í•¨
                    items.push(`- ë¬¸í•­ ${q.id} [${q.type}] "${q.kr}": ${v}ì  (${v==1?'ì „í˜€ì•„ë‹˜':'ë§¤ìš°ê·¸ë ‡ë‹¤'})`);
                }
            });
            if (items.length > 0) sRes = "\n[ì£¼ìš” ì‘ë‹µ íŒ¨í„´ (1ì /5ì  ë¬¸í•­)]\n" + items.join("\n");
        }
        
        // [ë³€ê²½] í”„ë¡¬í”„íŠ¸ ê³ ë„í™”: ë¬¸í•­ë³„ ì‘ë‹µ ë°ì´í„°ë¥¼ ë°˜ì˜í•˜ë„ë¡ ì§€ì‹œ ì¶”ê°€
        const prompt = `
ë‹¹ì‹ ì€ HDí˜„ëŒ€ì‚¼í˜¸ì˜ ì™¸êµ­ì¸ ì¸ë ¥ ì±„ìš© ì „ë¬¸ê°€ì´ì ì¸ì‚¬ í‰ê°€ê´€ì…ë‹ˆë‹¤. ì œê³µëœ í›„ë³´ìì˜ ì¸ì„±ê²€ì‚¬ ê²°ê³¼ ë°ì´í„°ì™€ **ì£¼ìš” ë¬¸í•­ë³„ ì‘ë‹µ ë‚´ì—­**ì„ ë°”íƒ•ìœ¼ë¡œ ì±„ìš© ë©´ì ‘ê´€ê³¼ í˜„ì¥ ê´€ë¦¬ìê°€ ì°¸ê³ í•  ìˆ˜ ìˆëŠ” **êµ¬ì¡°í™”ëœ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ**ë¥¼ ì‘ì„±í•˜ì‹­ì‹œì˜¤. 

í›„ë³´ìëŠ” ì¡°ì„ ì—… E-7-3 ìš©ì ‘ê³µ, ì „ê¸°ê³µ, ë„ì¥ê³µ ëŒ€ìƒì´ë©°, ì™¸êµ­ì¸ ìƒì‚°ì§ íŠ¹ì„±ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.

**[ë¶„ì„ ì§€ì¹¨]**
1. **ë°ì´í„° ê¸°ë°˜ ì¶”ë¡ :** ë‹¨ìˆœíˆ "ì ìˆ˜ê°€ ë‚®ë‹¤"ê³  í•˜ì§€ ë§ê³ , **ì œê³µëœ [ì£¼ìš” ì‘ë‹µ íŒ¨í„´]ì˜ êµ¬ì²´ì ì¸ ë¬¸í•­ ë‚´ìš©**ì„ ê·¼ê±°ë¡œ ë“¤ì–´ ì„¤ëª…í•˜ì‹­ì‹œì˜¤. 
    - ì˜ˆì‹œ: "ì•ˆì „ ì ìˆ˜ê°€ ë‚®ì€ë°, íŠ¹íˆ 'ë³´í˜¸êµ¬ ì°©ìš©ì´ ë¶ˆí¸í•˜ë©´ ì•ˆ ì¨ë„ ëœë‹¤'ëŠ” ë¬¸í•­ì— ë™ì˜í•œ ê²ƒìœ¼ë¡œ ë³´ì•„..."
2. **í˜„ì¥ ë°€ì°©í˜• ì¡°ì–¸:** ì¶”ìƒì ì¸ ì¡°ì–¸ ëŒ€ì‹ , ì‘ì—… í˜„ì¥ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ì‹œë‚˜ë¦¬ì˜¤(ì˜¤ì‘ë™, ë‹¤íˆ¼, ì§€ê° ë“±)ë¥¼ ì˜ˆì¸¡í•˜ì‹­ì‹œì˜¤.
3. **í˜•ì‹ ë° ê°€ë…ì„± ì¤€ìˆ˜:** - ë°˜ë“œì‹œ ì•„ë˜ [ì¶œë ¥ ì–‘ì‹] ë§ˆí¬ë‹¤ìš´ í¬ë§·ì„ ê·¸ëŒ€ë¡œ ë”°ë¥´ì‹­ì‹œì˜¤.
    - **í‘œì˜ 'êµ¬ë¶„' ì—´ì€ í…ìŠ¤íŠ¸ê°€ ì„¸ë¡œë¡œ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šë„ë¡, 2~4ê¸€ì ë‹¨ìœ„ë¡œ ì ì ˆíˆ ì¤„ë°”ê¿ˆ(<br>) íƒœê·¸ë¥¼ ë„£ì–´ ì‘ì„±í•˜ì‹­ì‹œì˜¤. (ì˜ˆ: 'ê°•ì <br>ìš”ì¸', 'ì‘ì—…<br>ë°°ì¹˜ ì‹œ')**

**[í›„ë³´ì ê¸°ë³¸ ì •ë³´]**
- ì„±ëª…: ${d.name} (${d.id})
- ì‘ì‹œì¼ì: ${d.date || 'N/A'}
- ì¢…í•© ì ìˆ˜: ${d.total}ì  (ë“±ê¸‰: ${d.decision})
- ì‹ ë¢°ë„: ${d.reliability}

**[ì„¸ë¶€ ì—­ëŸ‰ ì ìˆ˜]**
(ê° ì˜ì—­ 100ì  ë§Œì  í™˜ì‚° ì ìˆ˜)
| ì˜ì—­ | í•­ëª© | ì ìˆ˜ | ìƒíƒœ |
|---|---|---|---|
| ê·¼íƒœ/ì±…ì„ | ê·¼íƒœ(C1) | ${d.details.C1} | ${d.details.C1 >= 80 ? 'ìš°ìˆ˜' : d.details.C1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ì±…ì„(C2) | ${d.details.C2} | ${d.details.C2 >= 80 ? 'ìš°ìˆ˜' : d.details.C2 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| ê·œë²”/ì •ì§ | ê·œì •(R1) | ${d.details.R1} | ${d.details.R1 >= 80 ? 'ìš°ìˆ˜' : d.details.R1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ì •ì§(R2) | ${d.details.R2} | ${d.details.R2 >= 80 ? 'ìš°ìˆ˜' : d.details.R2 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| ì¡°ì§/í˜‘ë ¥ | í˜‘ë ¥(T1) | ${d.details.T1} | ${d.details.T1 >= 80 ? 'ìš°ìˆ˜' : d.details.T1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ê°ˆë“±(T2) | ${d.details.T2} | ${d.details.T2 >= 80 ? 'ìš°ìˆ˜' : d.details.T2 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| ì •ì„œ/ì•ˆì „ | ê°ì •(E1) | ${d.details.E1} | ${d.details.E1 >= 80 ? 'ìš°ìˆ˜' : d.details.E1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ì•ˆì „(S1) | ${d.details.S1} | ${d.details.S1 >= 80 ? 'ìš°ìˆ˜' : d.details.S1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ìœ„í—˜(S2) | ${d.details.S2} | ${d.details.S2 >= 80 ? 'ìš°ìˆ˜' : d.details.S2 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| ì ì‘/í•™ìŠµ | í•™ìŠµ(A1) | ${d.details.A1} | ${d.details.A1 >= 80 ? 'ìš°ìˆ˜' : d.details.A1 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |
| | ì ì‘(A2) | ${d.details.A2} | ${d.details.A2 >= 80 ? 'ìš°ìˆ˜' : d.details.A2 >= 60 ? 'ë³´í†µ' : 'ì£¼ì˜'} |

${sRes}

**[ì¶œë ¥ ì–‘ì‹]**
## 1. ğŸ“‹ ì¢…í•© í‰ê°€ ìš”ì•½
(í›„ë³´ìì˜ ì „ë°˜ì ì¸ ì¸ì„± ìˆ˜ì¤€ê³¼ ì¡°ì§ ì í•©ì„±ì„ 3ì¤„ ë‚´ì™¸ë¡œ ìš”ì•½. ì´ì ì´ ë†’ìœ¼ë©´ ê¸ì •ì , ë‚®ìœ¼ë©´ ìš°ë ¤ì  ìœ„ì£¼ë¡œ ì„œìˆ . ì‹ ë¢°ë„ê°€ ë‚®ìœ¼ë©´ ê·¸ ì›ì¸ì„ ë¬¸í•­ íŒ¨í„´ì—ì„œ ì°¾ì•„ ì–¸ê¸‰.)

## 2. ğŸ“Š ì—­ëŸ‰ ìƒì„¸ ë¶„ì„
| êµ¬ë¶„ | ë¶„ì„ ë‚´ìš© |
| :---: | :----- |
| **ê°•ì <br>ìš”ì¸**| (ì ìˆ˜ê°€ ë†’ì€ ì˜ì—­ì„ ì–¸ê¸‰í•˜ë˜, í•´ë‹¹ ì˜ì—­ì˜ **êµ¬ì²´ì ì¸ ë¬¸í•­(ê¸ì • ì‘ë‹µ)**ì„ ì˜ˆì‹œë¡œ ë“¤ì–´ ì–´ë–¤ í–‰ë™ íŠ¹ì„±ì´ ê¸°ëŒ€ë˜ëŠ”ì§€ ì„œìˆ ) |
| **ë³´ì™„<br>í•„ìš”**| (ì ìˆ˜ê°€ ë‚®ì€ ì˜ì—­ì´ë‚˜ **ë¶€ì •ì ì¸ ì‘ë‹µì„ í•œ ë¬¸í•­**ì„ ì½• ì§‘ì–´ì„œ ì–¸ê¸‰í•˜ê³ , ë°œìƒ ê°€ëŠ¥í•œ ë¦¬ìŠ¤í¬ ì„œìˆ . ì—†ìœ¼ë©´ 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ') |

## 3. ğŸ—ï¸ í˜„ì¥ ê´€ë¦¬ ê°€ì´ë“œ (ì§/ë°˜ì¥ìš©)
| êµ¬ë¶„ | ê´€ë¦¬ ì¡°ì–¸ |
| :---: | :----- |
| **ì‘ì—…<br>ë°°ì¹˜ ì‹œ**| (ì•ˆì „/ê·œë²” ì ìˆ˜ ë° ê´€ë ¨ ë¬¸í•­ ì‘ë‹µì„ ê³ ë ¤í•˜ì—¬ ìœ„í—˜ ì‘ì—… ë°°ì¹˜ ì—¬ë¶€ ì¡°ì–¸)|
| **ì†Œí†µ<br>ë° ì§€ì‹œ**| (í˜‘ë ¥/ì ì‘ ì ìˆ˜ë¥¼ ê³ ë ¤í•œ ì˜ì‚¬ì†Œí†µ ë°©ì‹ ì œì•ˆ)|
| **ê·¼íƒœ<br>ê´€ë¦¬**| (ê·¼íƒœ/ì±…ì„ ì ìˆ˜ì™€ ê´€ë ¨ ë¬¸í•­ ë‹µë³€ì„ í† ëŒ€ë¡œ í•œ ê´€ë¦¬ í¬ì¸íŠ¸)|

## 4. ğŸ’¬ ì‹¬ì¸µ ë©´ì ‘ê´€ì„ ìœ„í•œ ì§ˆë¬¸ ê°€ì´ë“œ
| ì˜ì—­ | í•µì‹¬ ì§ˆë¬¸ (Probe Question) | ë¶„ì„ ëª©ì  |
| :---: | :--- | :--- |
| **(ì·¨ì•½ì˜ì—­1)** | "(ì·¨ì•½í•œ ë¶€ë¶„ê³¼ ê´€ë ¨ëœ ìƒí™© ì œì‹œí˜• ì§ˆë¬¸... ì˜ˆ: ì•ˆì „ì¥ë¹„ê°€ ë¶ˆí¸í•  ë•Œ ì–´ë–»ê²Œ í•˜ê² ëŠ”ê°€?)" | (ì§ˆë¬¸ ì˜ë„) |
| **(ì·¨ì•½ì˜ì—­2)** | "(ë˜ ë‹¤ë¥¸ ì·¨ì•½ì  ê´€ë ¨ ì§ˆë¬¸)" | (ì§ˆë¬¸ ì˜ë„) |
`;
        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });
        const data = await res.json();
        if (!data.candidates || !data.candidates[0]) { throw new Error(data.error?.message || "API ì‘ë‹µ ì˜¤ë¥˜"); }
        con.innerHTML = `<div class="a4-page ai-report-page" style="margin-top:20px;height:auto!important;min-height:297mm;overflow:visible!important;"><div class="report-header"><div><img src="hd_logo.png" style="height:32px;margin-bottom:4px;" onerror="this.style.display='none'"><div class="text-3xl font-black text-[#002c5f] font-eng uppercase">ì¸ì„±ê²€ì‚¬ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ</div></div><div class="text-right"><div class="text-xs text-gray-400 font-bold uppercase tracking-widest">Confidential Report</div><div class="text-lg font-black text-gray-800 font-kor">${d.name} <span class="text-base text-gray-500 font-bold">(${d.id})</span></div><div class="text-lg font-bold text-gray-500 font-eng mt-1">${getYYYYMMDD(d.date||new Date())}</div></div></div><div class="bg-slate-50 border border-slate-200 rounded-2xl p-8 ai-markdown flex-grow">${marked.parse(data.candidates[0].content.parts[0].text)}</div><div class="mt-4 pt-4 border-t border-gray-100 text-center text-[10px] text-gray-300 font-black uppercase tracking-[0.4em]">HD HYUNDAI SAMHO </div></div>`;
        btn.style.display = 'none';
        updateReportScale(); // AI ë¶„ì„ í›„ ë¦¬ì‚¬ì´ì§•
    } catch (e) {
        console.error(e);
        btn.innerHTML = 'ìƒì„± ì‹¤íŒ¨ (ì¬ì‹œë„)';
        btn.disabled = false;
        btn.classList.remove('opacity-50');
        alert("AI ë¶„ì„ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.message);
    }
}
function generateReportComment(d) {
    const scores = d.details;
    const diag = d.diagnosis || {};
    let comments = [];
    if (d.decision.includes('S')) comments.push("ì¡°ì§ ì ì‘ë ¥ê³¼ ì§ë¬´ ìˆ˜í–‰ ì—­ëŸ‰ì´ ë§¤ìš° íƒì›”í•œ ìµœìƒìœ„ ì¸ì¬êµ°ì…ë‹ˆë‹¤.");
    else if (d.decision.includes('A')) comments.push("ëŒ€ë¶€ë¶„ì˜ ì—­ëŸ‰ì´ ìš°ìˆ˜í•˜ë©°, ì¡°ì§ ìƒí™œì— ê¸ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.");
    else if (d.decision.includes('B1')) comments.push("ì§ë¬´ ìˆ˜í–‰ì— í•„ìš”í•œ ê¸°ë³¸ì ì¸ ì†Œì–‘ì„ ê°–ì¶”ê³  ìˆì–´, í˜„ì¥ ì ì‘ì— ë¬´ë¦¬ê°€ ì—†ì„ ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.");
    else if (d.decision.includes('B2')) comments.push("ì§ë¬´ ì—­ëŸ‰ì´ ë‹¤ì†Œ í‰ì´í•˜ê±°ë‚˜ ì†Œê·¹ì ì¸ íƒœë„ê°€ ì—¿ë³´ì—¬, ì…ì‚¬ í›„ ë™ê¸° ë¶€ì—¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.");
    else if (d.decision.includes('C')) comments.push("ì¼ë¶€ ì—­ëŸ‰ì—ì„œ ìœ„í—˜ ìš”ì¸ì´ ê°ì§€ë˜ê±°ë‚˜ ì‹ ë¢°ë„ì— ì´ìŠˆê°€ ìˆì–´, ì±„ìš© ì‹œ ì£¼ì˜ ê¹Šì€ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.");
    else if (d.decision.includes('D')) comments.push("ì¡°ì§ ë¶€ì ì‘ ìœ„í—˜ì´ ë§¤ìš° ë†’ê±°ë‚˜ ë¶ˆì„±ì‹¤í•œ ì‘ë‹µ íƒœë„ê°€ ë°œê²¬ë˜ì–´, í˜„ì¥ íˆ¬ì…ì´ ìš°ë ¤ë©ë‹ˆë‹¤.");
    const sortedKeys = Object.keys(scores).sort((a,b) => scores[b] - scores[a]);
    const topKey = sortedKeys[0];
    const topScore = scores[topKey];
    if (topScore >= 80) {
        if (topKey.startsWith('S')) comments.push("íŠ¹íˆ ì•ˆì „ ì˜ì‹ì´ ë§¤ìš° íˆ¬ì² í•˜ì—¬, ìœ„í—˜í•œ í˜„ì¥ì—ì„œë„ ìˆ˜ì¹™ì„ ì² ì €íˆ ì¤€ìˆ˜í•  ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.");
        else if (topKey.startsWith('C')) comments.push("ê·¼íƒœì™€ ì±…ì„ê°ì´ ê°•ì ì´ë©°, ë§¡ì€ ì—…ë¬´ë¥¼ ëê¹Œì§€ ì™„ìˆ˜í•˜ë ¤ëŠ” ì„±ì‹¤í•¨ì´ ë‹ë³´ì…ë‹ˆë‹¤.");
        else if (topKey.startsWith('R')) comments.push("ê·œì • ì¤€ìˆ˜ ì˜ì‹ì´ ë†’ì•„ ê´€ë¦¬ìì˜ ì§€ì‹œë¥¼ ì˜ ë”°ë¥´ê³  ì¡°ì§ ì§ˆì„œë¥¼ ì¡´ì¤‘í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.");
        else if (topKey.startsWith('T')) comments.push("ë™ë£Œì™€ì˜ í˜‘ë ¥ íƒœë„ê°€ ìš°ìˆ˜í•˜ì—¬ íŒ€ ë¶„ìœ„ê¸°ë¥¼ ê¸ì •ì ìœ¼ë¡œ ì´ëŒ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.");
        else if (topKey.startsWith('E')) comments.push("ê°ì • ì¡°ì ˆ ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ê³  ì¹¨ì°©í•˜ì—¬, í˜„ì¥ì˜ ëŒë°œ ìƒí™©ì—ë„ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•  ê²ƒì…ë‹ˆë‹¤.");
        else if (topKey.startsWith('A')) comments.push("ìƒˆë¡œìš´ í™˜ê²½ì— ëŒ€í•œ ì ì‘ë ¥ì´ ë›°ì–´ë‚˜ê³  ì—…ë¬´ ìŠµë“ ì†ë„ê°€ ë¹ ë¥¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.");
    }
    if (diag.sFail) { comments.push("ğŸš¨ [ì£¼ì˜] ì•ˆì „ ê´€ë ¨ ì¸ì‹ ì ìˆ˜ê°€ ê¸°ì¤€(60ì )ë³´ë‹¤ ë‚®ìŠµë‹ˆë‹¤. í˜„ì¥ ë°°ì¹˜ ì „ ê°•ë„ ë†’ì€ ì•ˆì „ êµìœ¡ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤."); } 
    else {
        const weakKey = sortedKeys[sortedKeys.length - 1];
        if (scores[weakKey] < 60) {
            if (weakKey.startsWith('T')) comments.push("ë‹¤ë§Œ, ë‹¨ì²´ ìƒí™œì—ì„œ ë‹¤ì†Œ ê°œì¸ì£¼ì˜ì ì¸ ì„±í–¥ì´ ë‚˜íƒ€ë‚  ìˆ˜ ìˆì–´ íŒ€ì›Œí¬ ë°°ì–‘ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            else if (weakKey.startsWith('E')) comments.push("ë‹¤ë§Œ, ì—…ë¬´ ìŠ¤íŠ¸ë ˆìŠ¤ì— ë‹¤ì†Œ ì·¨ì•½í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê´€ë¦¬ìì˜ ì„¸ì‹¬í•œ ë°°ë ¤ì™€ ê´€ì‹¬ì´ ìš”êµ¬ë©ë‹ˆë‹¤.");
            else if (weakKey.startsWith('C')) comments.push("ë‹¤ë§Œ, ê·¼íƒœë‚˜ ì‹œê°„ ê´€ë¦¬ ì¸¡ë©´ì—ì„œ ë‹¤ì†Œ ëŠìŠ¨í•œ ê²½í–¥ì´ ìˆì–´ ì´ˆë°˜ ê´€ë¦¬ê°€ í•„ìš”í•´ ë³´ì…ë‹ˆë‹¤.");
        }
    }
    return comments.join(" ");
}
function generateReliabilityComment(d) {
    const diag = d.diagnosis || {};
    let msg = "";
    if (d.reliability.includes('V1')) msg = "ì‘ë‹µì˜ ì¼ê´€ì„±ì´ ë§¤ìš° ë†’ê³ , ìì‹ ì˜ ëª¨ìŠµì„ ì†”ì§í•˜ê²Œ ë“œëŸ¬ëƒˆìŠµë‹ˆë‹¤. ê²°ê³¼ì˜ ì‹ ë¢°ë„ê°€ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤.";
    else if (d.reliability.includes('V2')) msg = "ì „ë°˜ì ìœ¼ë¡œ ì¼ê´€ëœ ì‘ë‹µì„ ë³´ì˜€ìœ¼ë©°, ê²°ê³¼ í•´ì„ì— ë¬´ë¦¬ê°€ ì—†ëŠ” ì–‘í˜¸í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.";
    else if (d.reliability.includes('V3')) msg = "ì¼ë¶€ ì‘ë‹µì—ì„œ ì‹ ë¢°ë„ë¥¼ ì €í•´í•  ìˆ˜ ìˆëŠ” ìš”ì¸ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ";
    else msg = "ì‘ë‹µì˜ ì‹ ë¢°ë„ê°€ ë§¤ìš° ë‚®ì•„, ë³¸ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ì±„ìš© ê·¼ê±°ë¡œ í™œìš©í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ";
    if (d.reliability.includes('V3') || d.reliability.includes('V4') || d.reliability.includes('V5')) {
        let reasons = [];
        if (diag.l1 >= 3) reasons.push("ìì‹ ì„ ì§€ë‚˜ì¹˜ê²Œ ê¸ì •ì ìœ¼ë¡œ í¬ì¥í•˜ë ¤ëŠ” ê²½í–¥(ìê¸° ê³¼ì‹œ)");
        if (diag.maxC >= 15) reasons.push("íŠ¹ì • ë²ˆí˜¸ë¥¼ ì—°ì†ì ìœ¼ë¡œ ì„ íƒí•œ ë¶ˆì„±ì‹¤ ì‘ë‹µ íŒ¨í„´");
        if (d.isTooFast || diag.isTimeCut) reasons.push("ì§€ë‚˜ì¹˜ê²Œ ë¹ ë¥¸ ì‘ë‹µ ì†ë„(ë¬¸í•­ ë¯¸ìˆ™ì§€ ì˜ì‹¬)");
        if (reasons.length > 0) { msg += "ì£¼ìš” ì›ì¸ì€ **" + reasons.join(", ") + "**ì…ë‹ˆë‹¤. ë©´ì ‘ ì‹œ ì§„ìœ„ ì—¬ë¶€ë¥¼ ì¬í™•ì¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤."; }
    }
    return msg;
}
window.showReport=function(d){
    currentViewingData=d;
    const factors=Object.keys(d.details);
    const stats={};
    let validStatsData=[...globalLocalData,...globalFileData].filter(item=>{const r=String(item.reliability||"");return !r.includes("V4")&&!r.includes("V5")});
    if(validStatsData.length===0){validStatsData=[...globalLocalData,...globalFileData].length>0?[...globalLocalData,...globalFileData]:[d]}
    factors.forEach(f=>{ const values=validStatsData.map(r=>r.details[f]||0); stats[f]={avg:(values.reduce((a,b)=>a+b,0)/values.length).toFixed(1)}; });
    const reportView=document.getElementById('view-report');
    const wrapper=document.getElementById('report-content-wrapper');
    reportView.classList.remove('hidden');
    reportView.classList.add('active');
    const decDesc = generateReportComment(d);
    const relDesc = generateReliabilityComment(d);
    const getGradeColor=(str)=>{if(str.includes('S')||str.includes('ìµœìš°ìˆ˜'))return '#1e40af';if(str.includes('A')||str.includes('ìš°ìˆ˜'))return '#2563eb';if(str.includes('B')||str.includes('ë³´í†µ'))return '#059669';if(str.includes('C')||str.includes('ì£¼ì˜'))return '#d97706';return '#dc2626'};
    const getRelColor=(str)=>{if(str.includes('V1')||str.includes('ë†’ìŒ'))return '#1e40af';if(str.includes('V2'))return '#2563eb';if(str.includes('V3'))return '#d97706';return '#dc2626'};
    const getGrade=(s)=>{if(s>=90)return{t:'S',c:'grade-S'};if(s>=80)return{t:'A',c:'grade-A'};if(s>=60)return{t:'B',c:'grade-B'};if(s>=40)return{t:'C',c:'grade-C'};return{t:'D',c:'grade-D'}};
    // [ìˆ˜ì •] flex -> grid grid-cols-2 ë¡œ ë³€ê²½í•˜ì—¬ í•˜ë‹¨ ì˜ì—­ê³¼ ì •ë ¬ ì¶•ì„ í†µì¼í•¨
    wrapper.innerHTML=`<div class="a4-page"><div class="report-header"><div><img src="hd_logo.png" class="h-10 mb-2" onerror="this.style.display='none';this.nextElementSibling.style.display='block'"><div class="text-3xl font-black text-[#002c5f] tracking-tighter uppercase font-eng">HD HYUNDAI SAMHO</div><div class="text-sm font-black text-gray-400 mt-1 uppercase tracking-widest font-kor">E-7 ì™¸êµ­ì¸ ê·¼ë¡œì ì¸ì„±ê²€ì‚¬ ë¦¬í¬íŠ¸</div></div><div class="text-right"><div class="text-[10px] text-white bg-[#002c5f] px-2 py-0.5 rounded font-bold uppercase inline-block mb-1">Official Document</div><div class="text-lg font-black text-gray-800 font-kor">${d.name} <span class="text-base text-gray-500 font-bold">(${d.id})</span></div><div class="text-lg font-bold text-gray-500 font-eng mt-1">${getYYYYMMDD(d.date||new Date())}</div></div></div><div class="grid grid-cols-4 gap-4 mb-8"><div class="score-card highlight-card"><div class="label">ì¢…í•© ì ìˆ˜</div><div class="value">${d.total}</div></div><div class="score-card"><div class="label">ì¢…í•© ë“±ê¸‰</div><div class="value" style="color:${getGradeColor(d.decision)}">${d.decision.split(' (')[0]}</div></div><div class="score-card"><div class="label">ì‹ ë¢°ë„</div><div class="value" style="color:${getRelColor(d.reliability)}">${d.reliability.split(' (')[0]}</div></div><div class="score-card"><div class="label">ìµœì € ì ìˆ˜</div><div class="value" style="color:#64748b">${d.minScore}</div></div></div><div class="grid grid-cols-2 gap-8 mb-6 h-[480px]"><div class="flex flex-col h-full"><div class="section-title"><span>ğŸ“Š</span> ì—­ëŸ‰ ë¹„êµ í”„ë¡œíŒŒì¼</div><div class="chart-wrapper flex-1 relative bg-white rounded-xl p-2 w-full"><canvas id="mainChart"></canvas></div></div><div class="flex flex-col h-full"><div class="section-title"><span>ğŸ“</span> ì„¸ë¶€ ì ìˆ˜ ë° ë“±ê¸‰</div><div class="flex-1 w-full"><table class="score-table h-full w-full">${Object.keys(d.details).map(k=>{const s=d.details[k],g=getGrade(s),c=s>=80?'#1e3a8a':(s>=60?'#3b82f6':'#ef4444');return`<tr><td width="35%"><span class="font-eng text-slate-400 text-[10px] mr-1">${k}</span>${MGMT_GUIDE[k].title}</td><td width="15%" class="text-center"><span class="grade-badge ${g.c}">${g.t}</span></td><td width="35%"><div style="background:#f1f5f9;border-radius:4px;height:8px;overflow:hidden"><div style="width:${s}%;background:${c};height:100%"></div></div></td><td width="15%" style="color:${c};font-weight:800;text-align:center;">${s}</td></tr>`}).join('')}</table></div></div></div><div class="grid grid-cols-2 gap-8 border-t border-transparent pt-6" style="margin-top:0.1cm;"><div class="flex flex-col h-full"><div class="section-title"><span>ğŸ“Œ</span> ì¢…í•© íŒì •</div><div class="bg-white rounded-xl border border-[#e2e8f0] p-5 flex-grow shadow-sm"><p class="text-[0.95rem] text-slate-700 leading-relaxed text-justify break-keep font-medium">${decDesc}</p></div></div><div class="flex flex-col h-full"><div class="section-title"><span>ğŸ”</span> ì‹ ë¢°ë„ ë¶„ì„</div><div class="bg-white rounded-xl border border-[#e2e8f0] p-5 flex-grow shadow-sm"><p class="text-[0.95rem] text-slate-700 leading-relaxed text-justify break-keep font-medium">${relDesc}</p></div></div></div></div><div id="ai-result-container"></div><div class="text-center no-print my-10 pb-20"><button onclick="window.printReportContent()" class="bg-slate-800 hover:bg-slate-700 text-white px-8 py-4 rounded-xl font-bold shadow-lg mr-4 transition-all hover:-translate-y-1">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button><button id="btn-ai-generate" onclick="generateAIAnalysis(currentViewingData)" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-black py-4 px-8 rounded-xl shadow-lg transition-all hover:-translate-y-1 hover:shadow-xl inline-flex items-center gap-2"><span>âœ¨</span> AI ì‹¬ì¸µ ë¶„ì„ (Premium)</button><button onclick="window.closeReport()" class="bg-white border hover:bg-gray-50 text-gray-600 px-8 py-4 rounded-xl font-bold ml-4 shadow-sm">ë‹«ê¸°</button></div>`;
    if(chartInstance)chartInstance.destroy();
    Chart.register(ChartDataLabels);
    chartInstance=new Chart(document.getElementById('mainChart').getContext('2d'),{type:'bar',data:{labels:Object.keys(d.details).map(k=>MGMT_GUIDE[k].title),datasets:[{label:'í‰ê· ',data:Object.keys(d.details).map(k=>stats[k].avg),type:'line',borderColor:'#ef4444',borderWidth:3,pointBackgroundColor:'#ef4444',tension:0.3,order:0,datalabels:{color:'#ef4444',anchor:'start',align:'right',offset:6,font:{weight:'bold',size:13},formatter:Math.round}},{label:'ë³¸ì¸',data:Object.values(d.details),backgroundColor:'rgba(30,58,138,0.9)',borderRadius:4,barPercentage:1.0,categoryPercentage:0.8,order:1,datalabels:{color:'white',anchor:'center',align:'center',font:{weight:'bold',size:13}}}]},options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',scales:{x:{min:0,max:110,grid:{color:'#f1f5f9'},ticks:{font:{size:13,weight:'bold'}}},y:{grid:{display:false},ticks:{font:{family:"'Noto Sans KR'",weight:'700',size:13}}}},plugins:{legend:{position:'top'},datalabels:{display:true,formatter:Math.round}},layout:{padding:{right:30}}}});
    updateReportScale();
};
window.updateReportScale = function() {
    const reportWrapper = document.getElementById('report-content-wrapper');
    if(!reportWrapper) return;
    const a4 = reportWrapper.querySelector('.a4-page');
    if(!a4) return;
    const containerWidth = window.innerWidth - 40; 
    const a4Width = 794; // approx 210mm in pixels at 96dpi
    if(containerWidth < a4Width) {
        const scale = containerWidth / a4Width;
        reportWrapper.style.transform = `scale(${scale})`;
        // Height compensation for scaling
        reportWrapper.style.marginBottom = `-${(1-scale)*1123}px`; // 1123 is approx A4 height
    } else {
        reportWrapper.style.transform = 'none';
        reportWrapper.style.marginBottom = '0';
    }
};
window.addEventListener('resize', window.updateReportScale);
window.printReportContent=function(){const cvs=document.getElementById('mainChart');const url=cvs?cvs.toDataURL("image/png"):'';const cts=document.getElementById('report-content-wrapper').innerHTML;const w=window.open('','_blank','width=1100,height=1010');if(!w)return window.showModal('íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ì£¼ì„¸ìš”.');w.document.write(`<html><head><title>ì¸ì„±ê²€ì‚¬ ë¦¬í¬íŠ¸</title><script src="https://cdn.tailwindcss.com/3.4.1"><\/script><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Roboto:wght@400;700;900&display=swap" rel="stylesheet"><style>@page{size:A4 portrait;margin:15mm 20mm}body{margin:0;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;font-family:'Noto Sans KR',sans-serif;background:white}.a4-page{width:100%!important;height:auto!important;min-height:98%!important;padding:0!important;margin:0!important;box-shadow:none!important;page-break-after:always;overflow:visible!important;display:flex;flex-direction:column}.a4-page:last-child{page-break-after:auto}.ai-report-page{min-height:auto!important;height:auto!important;display:block!important}.chart-wrapper{height:100%!important;width:100%!important;position:relative}.chart-wrapper canvas{display:none!important}.printed-chart-img{width:100%;height:100%;object-fit:contain;display:block}.no-print,button{display:none!important}.report-header{border-bottom:3px solid #002c5f;padding-bottom:12px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:flex-end}.score-card{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:10px;text-align:center}.score-card .label{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:#64748b;font-weight:700;margin-bottom:4px}.score-card .value{font-size:1.6rem;font-weight:900;color:#002c5f;line-height:1.2;font-family:'Noto Sans KR',sans-serif;word-break:keep-all}.score-card.highlight-card{background-color:#002c5f!important;border:1px solid #002c5f!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.score-card.highlight-card .label{color:#bfdbfe!important}.score-card.highlight-card .value{color:#ffffff!important}.section-title{font-size:1.2rem;font-weight:800;color:#002c5f;display:flex;align-items:center;gap:8px;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid #e2e8f0}.score-table{width:100%;font-size:0.8rem;border-collapse:separate;border-spacing:0 4px;height:100%}.score-table td{padding:3px 8px;border-top:1px solid #f1f5f9;border-bottom:1px solid #f1f5f9}.grade-badge{display:inline-block;width:22px;height:22px;line-height:22px;text-align:center;border-radius:50%;font-weight:900;font-size:0.8rem;color:white}.grade-S{background-color:#4f46e5!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grade-A{background-color:#3b82f6!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grade-B{background-color:#10b981!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grade-C{background-color:#f59e0b!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grade-D{background-color:#ef4444!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.ai-markdown h2{font-size:1.4rem;font-weight:900;color:#002c5f;margin-top:1.5rem;margin-bottom:1rem;border-bottom:3px solid #002c5f;padding-bottom:6px}.ai-markdown h3{font-size:1.1rem;font-weight:800;color:#334155;margin-top:1.2rem;margin-bottom:0.6rem;border-left:4px solid #3b82f6;padding-left:10px}.ai-markdown p{font-size:0.95rem;line-height:1.7;color:#1e293b;margin-bottom:0.8rem;text-align:justify;word-break:keep-all}.ai-markdown ul{list-style:none;padding:0;margin-bottom:1rem}.ai-markdown li{position:relative;padding-left:18px;font-size:0.95rem;color:#334155;margin-bottom:6px;line-height:1.6}.ai-markdown li::before{content:"â€¢";position:absolute;left:0;color:#3b82f6;font-weight:bold;font-size:1.2em}.ai-markdown table{width:100%!important;border-collapse:collapse!important;margin-bottom:1.2rem;font-size:0.9rem;border:2px solid #cbd5e1!important}.ai-markdown th{background-color:#f8fafc!important;padding:10px!important;border:1px solid #94a3b8!important;font-weight:800!important;color:#002c5f!important;text-align:center!important}.ai-markdown td{padding:8px 12px!important;border:1px solid #94a3b8!important;color:#1e293b!important;vertical-align:middle!important}.ai-markdown strong{color:#002c5f!important;font-weight:900!important}.ai-markdown blockquote{background:#f1f5f9!important;border-left:4px solid #002c5f!important;padding:1rem!important;margin:1rem 0!important;font-style:italic!important;color:#475569!important}</style></head><body>${cts}<script>const w=document.querySelector('.chart-wrapper');if(w&&'${url}'){const i=document.createElement('img');i.src='${url}';i.className='printed-chart-img';w.appendChild(i);const c=w.querySelector('canvas');if(c)c.remove()}setTimeout(()=>{window.print();window.close()},800)<\/script></body></html>`);w.document.close()};
window.closeReport=function(){document.getElementById('view-report').classList.remove('active');document.getElementById('view-report').classList.add('hidden')};
document.addEventListener('DOMContentLoaded',()=>{updateStoredCount();const ua=navigator.userAgent.toLowerCase();if(/kakaotalk|line|instagram|fbav/i.test(ua)){if(/android/i.test(ua))location.href='intent://'+location.href.replace(/https?:\/\//i,'')+'#Intent;scheme=http;package=com.android.chrome;end';document.getElementById('kakaotalk-guide').style.display='flex'}});
</script></body></html>
